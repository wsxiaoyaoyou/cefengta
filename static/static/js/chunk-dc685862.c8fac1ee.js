(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dc685862"],{"7e6c":function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a("b775");window.GLOBAL_CONFIG.VUE_APP_BASE_API;const i=window.GLOBAL_CONFIG.VUE_APP_BASE_API_2;function s(){return Object(r["a"])({url:i+"/atm/user/organizelist",method:"get"})}},b37e:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container",staticStyle:{"max-width":"900px",margin:"0 auto"}},[a("CurrencyForm",{ref:"currencyForm",attrs:{"ref-name":"insertTowerForm","config-data":e.formData,"set-fields-value":e.fieldsValue,"form-handle":e.formHandle,"label-width":"150px",inline:!1},on:{getData:e.submitData,changeDataType:e.handleChangeDataType,changeProvice:e.handleChangeProvice,changeLon:e.handleChangeLon,changeLat:e.handleChangeLat,inputCode:e.handleCodeFocus,"input-mail-pwd":e.handleMailPwd,"input-mail-code":e.handleMailCode}})],1)},i=[],s=a("1d71"),n=a("ccce"),l=a("7e6c"),u=a("b775");const o=window.GLOBAL_CONFIG.VUE_APP_BASE_API;function d(e){return Object(u["a"])({url:o+"/atm/mast/area",method:"get",params:e})}var c=a("eb91"),m=a("bc3a"),h=a.n(m);function p(e){return console.log(e),h.a.get("https://restapi.amap.com/v3/geocode/regeo",{params:e})}var f=a("ed08"),g={name:"InsertTowerFirstForm",components:{CurrencyForm:n["a"]},props:{isUpdate:{type:Boolean,default:!1},isStep:{type:Boolean,default:!1},defaultValue:{type:Object,default:()=>({ID:""})}},data(){return{proviceOptions:s["a"],formData:[{type:"elInput",variable:"ID",name:"测风塔编号:",colProps:{xl:12,lg:12,md:12},rules:[{required:!0,message:"请输入测风塔编号",trigger:"blur"},{pattern:/^[A-Za-z0-9]+$/,message:"只允许填写字母或数字",trigger:"blur",required:!0}]},{type:"elSelect",variable:"organize_uuid",name:"组织机构:",data:[],filterable:!0,allowCreate:!0,defaultFirstOption:!0,colProps:{xl:12,lg:12,md:12},required:!0,rules:[{required:!0,message:"请选择组织机构",trigger:["blur","change"]}]},{type:"elInput",variable:"NAME",name:"测风塔名称:",colProps:{xl:12,lg:12,md:12},rules:[{required:!0,message:"请输入测风塔名称",trigger:"blur"}]},{type:"elInput",variable:"LON",name:"经度(°E):",colProps:{xl:12,lg:12,md:12},rules:[{required:!0,message:"请输入经度",trigger:"blur"}],trigger:"change",emit:"changeLon"},{type:"elInput",variable:"LAT",name:"纬度(°N):",colProps:{xl:12,lg:12,md:12},rules:[{required:!0,message:"请输入纬度",trigger:"blur"}],trigger:"change",emit:"changeLat"},{type:"elSelect",variable:"DATATYPE",name:"测风状态:",data:[{label:"历史测风塔数据",value:"0"},{label:"仍实时更新测风塔数据",value:"1"},{label:"激光雷达数据",value:"2"}],colProps:{xl:12,lg:12,md:12},rules:[{required:!0,message:"请选择测风状态",trigger:["blur","change"]}],emit:"changeDataType"},{type:"elSelect",variable:"PROJECT",name:"所属项目:",data:[],filterable:!0,allowCreate:!0,defaultFirstOption:!0,colProps:{xl:12,lg:12,md:12},rules:[{required:!0,message:"请输入所属项目",trigger:["blur","change"]}]},{type:"elInput",variable:"CODE",name:"数据查看密码:",colProps:{xl:12,lg:12,md:12},trigger:"focus",emit:"inputCode"},{type:"elInput",variable:"MAILUSER",name:"邮箱用户名:",colProps:{xl:12,lg:12,md:12},required:!1,rules:[{required:!1,message:"请输入邮箱用户名",trigger:"blur"}]},{type:"elInput",variable:"MAILPASSWD",name:"邮箱密码:",colProps:{xl:12,lg:12,md:12},required:!1,rules:[{required:!1,message:"请输入邮箱密码",trigger:"blur"}],trigger:"focus",emit:"input-mail-pwd"},{type:"elInput",variable:"MAILCODE",name:"邮箱授权码:",colProps:{xl:12,lg:12,md:12},required:!1,rules:[{required:!1,message:"请输入邮箱授权码",trigger:"blur"}],trigger:"focus",emit:"input-mail-code"},{type:"elCascader",variable:"CITYS",name:"省市县:",options:[],colProps:{xl:12,lg:12,md:12},required:!1,props:{value:"label",label:"label",children:"children"},rules:[{required:!1,message:"请选择省市县",trigger:["blur","change"]}],emit:"changeProvice"},{type:"elInput",variable:"EQUIPTYPE",name:"设备型号:",colProps:{xl:12,lg:12,md:12}},{type:"elInput",variable:"ANGLE",name:"磁偏角:",colProps:{xl:12,lg:12,md:12},required:!1,rules:[{required:!1,message:"请输入磁偏角",trigger:"blur"}]},{type:"elInput",variable:"SHADOW",name:"塔影:",colProps:{xl:12,lg:12,md:12},required:!1,rules:[{required:!1,message:"请输入塔影",trigger:"blur"}]},{type:"elInput",variable:"ELE",name:"高程:",colProps:{xl:12,lg:12,md:12},required:!1,rules:[{required:!1,message:"请输入高程",trigger:"blur"}]},{type:"elInput",variable:"UTC",name:"时区:",colProps:{xl:12,lg:12,md:12},required:!1}],formHandle:[{type:"primary",name:"保存下一步",emit:"getData",colProps:{offset:10}}],fieldsValue:{},listLoading:!1,currentLonLat:[],currentProvice:"",currentProviceObj:null,currentCityObj:null,currentTownObj:null,activeNames:"1"}},watch:{isUpdate:{async handler(e){this.formData[0].disabled=e,1!==this.$store.getters.roles&&(this.formData[5].disabled=e,this.formData[6].disabled=e,this.formData[7].disabled=e,this.formData[8].disabled=e,this.formData[9].disabled=e,this.formData[10].disabled=e),e&&!this.isStep&&(this.formHandle=[{type:"primary",name:"保存",emit:"getData",colProps:{offset:10}}]),await this.getOrgOptions(),await this.getProjectList(),this.$nextTick(()=>{this.fieldsValue={...this.defaultValue,MAILPASSWD:this.isUpdate&&this.defaultValue.MAILPASSWD?"*****":void 0,MAILCODE:this.isUpdate&&this.defaultValue.MAILCODE?"*****":void 0,CODE:this.isUpdate&&this.defaultValue.CODE?"*****":void 0},this.formData[11].options=this.proviceOptions})},immediate:!0}},async mounted(){await this.getOrgOptions(),await this.getProjectList(),this.$nextTick(()=>{this.fieldsValue={...this.defaultValue,MAILPASSWD:this.isUpdate&&this.defaultValue.MAILPASSWD?"*****":void 0,MAILCODE:this.isUpdate&&this.defaultValue.MAILCODE?"*****":void 0,CODE:this.isUpdate&&this.defaultValue.CODE?"*****":void 0},this.formData[11].options=this.proviceOptions})},methods:{keepDecimal:f["g"],clearForm(){this.fieldsValue={},this.$refs.currencyForm.returnDisplay(this.fieldsValue)},async getOrgOptions(){const e=await Object(l["a"])();if(200===e.code){const t=e&&e.data;this.formData[1].data=[],t.forEach(e=>{this.formData[1].data.push({label:e,value:e})})}},async getProjectList(){const e=await Object(c["p"])();if(200===e.code){const t=e&&e.data;this.formData[6].data=[],Object.keys(t).forEach(e=>{this.formData[6].data.push({label:t[e],value:t[e]})})}},async getAreas(e){const t=await d(e);if(200===t.code){const a=t&&t.data;switch(e.level){case"1":this.formData[11].data=[],this.currentProviceObj=a,Object.keys(a).forEach(e=>{this.formData[11].data.push({label:a[e],value:e})});break;case"2":this.formData[12].data=[],this.currentCityObj=a,Object.keys(a).forEach(e=>{this.formData[12].data.push({label:a[e],value:e})});break;case"3":this.formData[13].data=[],this.currentTownObj=a,Object.keys(a).forEach(e=>{this.formData[13].data.push({label:a[e],value:e})});break;default:this.formData[11].data=[],Object.keys(a).forEach(e=>{this.formData[11].data.push({label:a[e],value:e})});break}}},handleChangeDataType(e){"1"==e.DATATYPE?(this.formData[8].rules=[{required:!0,message:"请输入邮箱用户名",trigger:"blur"}],this.formData[9].rules=[{required:!0,message:"请输入邮箱密码",trigger:"blur"}],this.formData[10].rules=[{required:!0,message:"请输入邮箱授权码",trigger:"blur"}]):(this.formData[8].rules=[{required:!1}],this.formData[9].rules=[{required:!1}],this.formData[10].rules=[{required:!1}])},async handleChangeProvice(e){const t={...e};this.fieldsValue=t,this.$refs.currencyForm.returnDisplay(this.fieldsValue)},async handleChangeCity(e){this.fieldsValue={...e,TOWN:""},await this.getAreas({level:"3",parentId:e.CITY}),this.$refs.currencyForm.returnDisplay(this.fieldsValue)},async handleReGeoCode(){const e=await p({key:"db114ff02792d0130714045f103f6960",location:this.currentLonLat.join(",")});if(e.data&&"1"==e.data.status&&"10000"===e.data.infocode){const t=e.data.regeocode&&e.data.regeocode.addressComponent;this.fieldsValue={...this.fieldsValue,CITYS:[t.province,t.city,t.district]},this.$refs.currencyForm.returnDisplay(this.fieldsValue)}},async handleChangeLon(e,t){this.currentLonLat.splice(0,1,t&&t["LON"]?this.keepDecimal(String(t["LON"]),6):""),this.currentLonLat[0]&&this.currentLonLat[1]&&(this.fieldsValue={...t,LON:this.currentLonLat[0],LAT:this.currentLonLat[1]},this.handleReGeoCode())},handleChangeLat(e,t){this.currentLonLat.splice(1,1,t["LAT"]?this.keepDecimal(String(t["LAT"]),6):""),this.currentLonLat[0]&&this.currentLonLat[1]&&(this.fieldsValue={...t,LON:this.currentLonLat[0],LAT:this.currentLonLat[1]},this.handleReGeoCode())},handleCodeFocus(e,t){this.fieldsValue={...t,CODE:""},this.$refs.currencyForm.returnDisplay(this.fieldsValue)},handleMailPwd(e,t){this.fieldsValue={...t,MAILPASSWD:""},this.$refs.currencyForm.returnDisplay(this.fieldsValue)},handleMailCode(e,t){this.fieldsValue={...t,MAILCODE:""},this.$refs.currencyForm.returnDisplay(this.fieldsValue)},async submitData(e){this.listLoading=!0,this.$refs.currencyForm.$refs.insertTowerForm.validate(async t=>{if(!t)return console.log("error submit!!"),!1;{const t={...e,PROVICE:e.CITYS?e.CITYS[0]:void 0,CITY:e.CITYS?e.CITYS[1]:void 0,TOWN:e.CITYS?e.CITYS[2]:void 0,STATUS:"1"==e.DATATYPE?"1":"2",CODE:e.CODE&&e.CODE.indexOf("*****")>=0?void 0:e.CODE,MAILPASSWD:e.MAILPASSWD&&e.MAILPASSWD.indexOf("*****")>=0?void 0:e.MAILPASSWD,MAILCODE:e.MAILCODE&&e.MAILCODE.indexOf("*****")>=0?void 0:e.MAILCODE};delete t.CITYS;const a=this.isUpdate?await Object(c["h"])(t):await Object(c["l"])({...t,STATUS:"1"==t.DATATYPE?"1":"2"});a&&200===a.code&&(this.$message({message:a&&a.msg||"提交成功",type:"success"}),this.isUpdate&&!this.isStep?this.$emit("success","edit",e):this.isUpdate?this.$emit("next-step","first",e):this.$emit("next-step","first",a.data))}}),this.listLoading=!1}}},b=g,O=a("2877"),D=Object(O["a"])(b,r,i,!1,null,null,null);t["a"]=D.exports},eb91:function(e,t,a){"use strict";a.d(t,"l",(function(){return n})),a.d(t,"h",(function(){return l})),a.d(t,"n",(function(){return u})),a.d(t,"j",(function(){return o})),a.d(t,"e",(function(){return d})),a.d(t,"g",(function(){return c})),a.d(t,"k",(function(){return m})),a.d(t,"t",(function(){return h})),a.d(t,"v",(function(){return p})),a.d(t,"m",(function(){return f})),a.d(t,"r",(function(){return g})),a.d(t,"q",(function(){return b})),a.d(t,"s",(function(){return O})),a.d(t,"d",(function(){return D})),a.d(t,"u",(function(){return L})),a.d(t,"x",(function(){return A})),a.d(t,"c",(function(){return y})),a.d(t,"y",(function(){return C})),a.d(t,"o",(function(){return P})),a.d(t,"w",(function(){return v})),a.d(t,"a",(function(){return I})),a.d(t,"i",(function(){return S})),a.d(t,"p",(function(){return E})),a.d(t,"b",(function(){return j})),a.d(t,"f",(function(){return w}));var r=a("b775");const i=window.GLOBAL_CONFIG.VUE_APP_BASE_API,s=window.GLOBAL_CONFIG.VUE_APP_BASE_API_2;function n(e){return Object(r["a"])({url:s+"/atm/mast/add",method:"post",data:e})}function l(e){return Object(r["a"])({url:s+"/atm/mast/edit",method:"post",data:e})}function u(e){return Object(r["a"])({url:s+"/atm/mast/mastDataSave",method:"get",params:e})}function o(e){return Object(r["a"])({url:s+"/atm/mast/mastDataShow",method:"post",data:e})}function d(){return Object(r["a"])({url:i+"/atm/mast/channeldict",method:"get"})}function c(e){return Object(r["a"])({url:s+"/atm/mast/mastDelete",method:"get",params:e})}function m(e){return Object(r["a"])({url:s+"/atm/warnTemp/showPage",method:"post",data:e})}function h(e){return Object(r["a"])({url:s+"/atm/warnTemp/mast",method:"get",params:e})}function p(e){return Object(r["a"])({url:s+"/atm/mast/editmastchannel",method:"post",data:e})}function f(e){return Object(r["a"])({url:s+"/atm/mast/mastChannelSave",method:"post",data:e})}function g(e){return Object(r["a"])({url:s+"/atm/rule/showPage",method:"post",data:e})}function b(e){return Object(r["a"])({url:s+"/atm/rule/delrule",method:"get",params:e})}function O(e){return Object(r["a"])({url:s+"/atm/templet/showPage",method:"post",data:e})}function D(e){return Object(r["a"])({url:s+"/atm/mast/delmastchannel",method:"post",data:e})}function L(e){return Object(r["a"])({url:s+"/atm/templet/deltemplet",method:"get",params:e})}function A(e){return Object(r["a"])({url:s+"/atm/mast/mastChannelGet",method:"get",params:e})}function y(e){return Object(r["a"])({url:s+"/atm/mast/channelShowPage",method:"post",data:e})}function C(e){return Object(r["a"])({url:s+"/atm/mast/mastfile",method:"post",data:e})}function P(e){return Object(r["a"])({url:s+"/atm/templet/addtemplet",method:"post",data:e})}function v(e){return Object(r["a"])({url:s+"/atm/templet/edittemplet",method:"post",data:e})}function I(e){return Object(r["a"])({url:s+"/atm/rule/addrule",method:"post",data:e})}function S(e){return Object(r["a"])({url:s+"/atm/rule/editrule",method:"post",data:e})}function E(e){return Object(r["a"])({url:s+"/atm/project/list",method:"get",params:e})}function j(e){return Object(r["a"])({url:s+"/atm/cleanTemp/mast",method:"get",params:e})}function w(e){return Object(r["a"])({url:s+"/atm/clearRules/describe",method:"post",data:e})}}}]);