(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c8a5944"],{"0ee8":function(t,e,a){"use strict";a("4653")},"165e":function(t,e,a){},"31ed":function(t,e,a){"use strict";a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return n})),a.d(e,"d",(function(){return l})),a.d(e,"e",(function(){return o})),a.d(e,"a",(function(){return d}));var i=a("b775");window.GLOBAL_CONFIG.VUE_APP_BASE_API;const s=window.GLOBAL_CONFIG.VUE_APP_BASE_API_2;function r(t){return Object(i["a"])({url:s+"/atm/mast/showMap",method:"get",params:t})}function n(t){return Object(i["a"])({url:s+"/atm/mast/showPage",method:"post",data:t})}function l(t){return Object(i["a"])({url:s+"/atm/mast/showPageTrue",method:"post",data:t})}function o(t){return Object(i["a"])({url:s+"/atm/mast/detail",method:"post",data:t})}function d(t){return Object(i["a"])({url:s+"/atm/mast/listTrue",method:"get",params:t})}},4653:function(t,e,a){},5403:function(t,e,a){"use strict";var i=a("ed08");e["a"]={data(){return{$_sidebarElm:null}},mounted(){this.__resizeHandler=Object(i["b"])(()=>{this.chart&&this.chart.resize()},100),window.addEventListener("resize",this.__resizeHandler),this.$_sidebarElm=document.getElementsByClassName("sidebar-container")[0],this.$_sidebarElm&&this.$_sidebarElm.addEventListener("transitionend",this.$_sidebarResizeHandler)},beforeDestroy(){window.removeEventListener("resize",this.__resizeHandler),this.$_sidebarElm&&this.$_sidebarElm.removeEventListener("transitionend",this.$_sidebarResizeHandler)},methods:{$_sidebarResizeHandler(t){"width"===t.propertyName&&this.__resizeHandler()}}}},"8eb1":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-tabs",{attrs:{type:"card",stretch:""},on:{"tab-click":t.handleTabChange},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"测风数据概览",name:"overflow"}},[a("CurrencyForm",{ref:"currencyForm",staticStyle:{display:"none"},attrs:{"ref-name":"overflowForm","config-data":t.formData,"form-handle":t.formHandle,"set-fields-value":t.defaultValue,inline:!0},on:{getData:t.getData,changeCode:t.handleChangeCode}}),t.notData?a("div",{staticStyle:{"text-align":"center"}},[a("svg-icon",{staticClass:"data-icon",attrs:{"icon-class":"notdata"}}),a("p",{staticStyle:{"font-size":"16px",color:"#ccc"}},[t._v("无数据")])],1):[a("el-descriptions",{staticClass:"margin-top",attrs:{title:"",column:2,border:""}},t._l(t.tableData,(function(e,i){return a("el-descriptions-item",{key:i},[a("template",{slot:"label"},[t._v("\n              "+t._s(e.label)+"\n            ")]),t._v("\n            "+t._s(e.value)+"\n          ")],2)})),1),a("el-row",{attrs:{gutter:20}},[a("el-col",{staticClass:"rosechart-wrap",attrs:{xl:{span:6},lg:{span:6},md:{span:8}}},[t.chartDataWd.length?a("rose-chart",{attrs:{"chart-data":t.chartDataWd,height:"600px",title:t.title.wd,"chart-x-data":t.chartXDataWd}}):t._e()],1),a("el-col",{staticClass:"rosechart-wrap",attrs:{xl:{span:6},lg:{span:6},md:{span:8}}},[t.chartDataWp.length?a("rose-chart",{attrs:{"chart-data":t.chartDataWp,height:"600px",title:t.title.wp,"chart-x-data":t.chartXDataWp}}):t._e()],1),a("el-col",{staticClass:"rosechart-wrap",attrs:{xl:{span:6},lg:{span:6},md:{span:8}}},[t.chartDataMonthws.length?a("line-chart",{attrs:{"chart-data":t.chartDataMonthws,title:t.title.monthws,height:"300px","chart-x-data":t.chartXDataMonthws}}):t._e(),t.chartDataWsdis.length?a("bar-chart",{attrs:{"chart-data":t.chartDataWsdis,title:t.title.wsdis,height:"300px","chart-x-data":t.chartXDataWsdis}}):t._e()],1),a("el-col",{staticClass:"rosechart-wrap",attrs:{xl:{span:6},lg:{span:6},md:{span:8}}},[t.chartDataDayws.length?a("line-chart",{attrs:{"chart-data":t.chartDataDayws,title:t.title.dayws,height:"300px","chart-x-data":t.chartXDataDayws}}):t._e(),t.chartDataWpdis.length?a("bar-chart",{attrs:{"chart-data":t.chartDataWpdis,title:t.title.wpdis,height:"300px","chart-x-data":t.chartXDataWpdis}}):t._e()],1)],1)]],2),a("el-tab-pane",{attrs:{label:"时间序列分析",name:"time-series"}},[a("time-series",{attrs:{"id-options":t.idOptions}})],1),a("el-tab-pane",{attrs:{label:"玫瑰图分析",name:"data-rose"}},[a("data-rose",{attrs:{"id-options":t.idOptions}})],1),a("el-tab-pane",{attrs:{label:"风速和风功率密度分析",name:"speed-powerdensity"}},[a("speed-powerdensity",{attrs:{"id-options":t.idOptions}})],1),a("el-tab-pane",{attrs:{label:"风速和风能频率分布分析",name:"energy-frequency"}},[a("energy-frequency",{attrs:{"id-options":t.idOptions}})],1),a("el-tab-pane",{attrs:{label:"威布尔分析",name:"weibull"}},[a("weibull",{attrs:{"id-options":t.idOptions}})],1),a("el-tab-pane",{attrs:{label:"风切变分析",name:"shear"}},[a("shear",{attrs:{"id-options":t.idOptions}})],1),a("el-tab-pane",{attrs:{label:"湍流计算",name:"turbulence"}},[a("turbulence",{attrs:{"id-options":t.idOptions}})],1),a("el-tab-pane",{attrs:{label:"50年最大风速预测",name:"maximum-speed-50years"}},[a("maximum-speed50years",{attrs:{"id-options":t.idOptions}})],1),a("el-tab-pane",{attrs:{label:"发电量估算",name:"energy-production"}},[a("energy-production",{attrs:{"id-options":t.idOptions}})],1),a("el-tab-pane",{attrs:{label:"散点分析",name:"scatter"}},[a("scatter",{attrs:{"id-options":t.idOptions}})],1),a("el-tab-pane",{attrs:{label:"统计分析",name:"statistic"}},[a("statistic",{attrs:{"id-options":t.idOptions}})],1),a("el-tab-pane",{attrs:{label:"数据导出",name:"export"}},[a("export",{attrs:{"id-options":t.idOptions}})],1)],1)],1)},s=[],r=a("ed08"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("CurrencyForm",{ref:"currencyForm",attrs:{"ref-name":"timeSeriesForm","form-key":0,"config-data":t.formData,"form-handle":t.formHandle,inline:!1,"set-fields-value":t.defaultValue},on:{changeCode:t.handleChangeCode,getData:t.getData}}),a("currency-chart",{attrs:{id:"time-series-chart",title:t.title,"chart-x-data":t.chartXData,"series-data":t.seriesData,"custom-config":t.customConfig,"list-loading":t.listLoading,height:t.chartHeight+"px","is-not-data":t.noData}})],1)},l=[],o=a("ccce"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{height:"100%"},attrs:{"element-loading-background":"rgba(150, 150, 150, 0.7)"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.notData,expression:"notData"}],staticStyle:{"text-align":"center"}},[a("svg-icon",{staticClass:"data-icon",attrs:{"icon-class":"notdata"}}),a("p",{staticStyle:{"font-size":"16px",color:"#ccc"}},[t._v("无数据")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.notData,expression:"!notData"}],class:t.className,style:{height:t.height,width:t.width||"calc(100vw - 310px)",minHeight:"300px"},attrs:{id:t.id}})])},h=[],c=a("313e"),m=a.n(c),u={data(){return{$_sidebarElm:null,$_resizeHandler:null}},mounted(){this.initListener()},activated(){this.$_resizeHandler||this.initListener(),this.resize()},beforeDestroy(){this.destroyListener()},deactivated(){this.destroyListener()},methods:{$_sidebarResizeHandler(t){"width"===t.propertyName&&this.$_resizeHandler()},initListener(){this.$_resizeHandler=Object(r["b"])(()=>{this.resize()},100),window.addEventListener("resize",this.$_resizeHandler),this.$_sidebarElm=document.getElementsByClassName("sidebar-container")[0],this.$_sidebarElm&&this.$_sidebarElm.addEventListener("transitionend",this.$_sidebarResizeHandler)},destroyListener(){window.removeEventListener("resize",this.$_resizeHandler),this.$_resizeHandler=null,this.$_sidebarElm&&this.$_sidebarElm.removeEventListener("transitionend",this.$_sidebarResizeHandler)},resize(){const{chart:t}=this;t&&t.resize()}}};a("817d");var g={name:"CurrencyChart",components:{},mixins:[u],props:{className:{type:String,default:"chart"},id:{type:String,default:"chart"},width:{type:String},height:{type:String,default:"450px"},theme:{type:String,default:"macarons"},isNotData:{type:Boolean,default:!0},chartData:{type:Object,default:function(){return{}}},clearChart:{type:Boolean,default:!1},title:{type:String,default:""},chartXData:{type:Array,default:function(){return[]}},seriesData:{type:Array,default:function(){return[{name:"",unit:"",type:"",data:[],other:""}]}},customConfig:{type:Array,default:function(){return[{path:[],val:""}]}},listLoading:{type:Boolean,default:!1}},data(){return{chart:null,notData:!1,yName:[],chartDatas:{width:"auto",grid:{top:100,left:"2%",right:60,bottom:60,containLabel:!0},toolbox:{feature:{saveAsImage:{title:"下载"}}},dataZoom:[{type:"slider",show:!1,xAxisIndex:[0],bottom:24},{type:"inside",xAxisIndex:[0],start:1,end:35}],title:{top:20,text:"",textStyle:{fontWeight:"normal",fontSize:16},left:"1%"},tooltip:{confine:!0,trigger:"item",axisPointer:{lineStyle:{}}},legend:{type:"scroll",orient:"horizontal",pageTextStyle:{color:"light"===this.theme?"#666":"#fff"},pageIconColor:"light"===this.theme?"#666":"#eee",pageIconSize:"10",top:50,icon:"rect",itemWidth:14,itemHeight:5,itemGap:13,right:"4%",textStyle:{fontSize:12}},xAxis:{type:"category",axisLabel:{interval:"auto",rotate:38},nameTextStyle:{color:"#F1F1F3"},axisLine:{lineStyle:{color:"dashboard"===this.theme?"#52ffff":"#88898b"}},splitLine:{lineStyle:{color:"dashboard"===this.theme?"#52ffff":"#88898b"}},data:[]},yAxis:[{type:"value",name:"",axisTick:{show:!1},nameTextStyle:{},axisLine:{lineStyle:{color:"dashboard"===this.theme?"#52ffff":"#88898b"}},axisLabel:{margin:10,textStyle:{fontSize:14}},splitLine:{lineStyle:{color:"dashboard"===this.theme?"#52ffff":"#88898b"}}}],series:[{yAxisIndex:0,type:"bar",name:"",data:[]}]}}},watch:{chartData:{deep:!0,handler(t){this.initConfig()}},seriesData:{deep:!0,immediate:!0,handler(t){0!==t.length?(this.isNotData&&(this.notData=!1),this.initConfig(t)):this.isNotData&&(this.notData=!0)}},isNotData:{handler(t){this.notData=t}},theme:{handler(t){this.chart&&(this.chart.dispose(),this.initChart())}}},mounted(){this.$nextTick(()=>{this.initChart("init")})},activated(){this.initConfig()},beforeDestroy(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart(t){this.chart=m.a.init(document.getElementById(this.id),this.theme),this.initConfig(t)},initConfig(t){if(this.clearChart&&this.clear(),"{}"===JSON.stringify(this.chartData)){if("init"!==t){var e=this.seriesData;const t=[];var a=new Set;for(const i in e)a.add(e[i].unit);this.yName=Array.from(a);for(const a in e){var i={type:e[a].type,name:e[a].name,data:e[a].data,itemStyle:{normal:{}},yAxisIndex:this.yName.indexOf(e[a].unit)};"gradientColor"===e[a].other&&(i.itemStyle.normal.color=new m.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#00FAFA"},{offset:.7,color:"#077ECA"},{offset:1,color:"#077ECA"}])),"horizontalLine"===e[a].other&&(i.renderItem=this.renderAverageItem,i.itemStyle.normal.color="#10FFB9",i.step="middle",i.encode={x:0,y:1}),t.push(i)}this.chartDatas.series=t;var s=[],r=0;for(const e in this.yName){var n={type:"value",name:"",axisTick:{show:!1},nameTextStyle:{},axisLine:{lineStyle:{color:"dashboard"===this.theme?"#52ffff":"#88898b"}},axisLabel:{margin:10,textStyle:{fontSize:14}},splitLine:{show:0===s.length,lineStyle:{color:"dashboard"===this.theme?"#52ffff":"#88898b"}}};n.name=this.yName[e],"0"===e?(n.position="left",s.push(n)):"1"===e?(n.position="right",s.push(n)):(n.position="right",n.offset=r+=50,s.push(n))}this.chartDatas.yAxis=s,this.customConfig.length>0&&0!==this.customConfig[0].path.length&&this.initCustomConfig(),this.addData()}}else setTimeout(()=>{this.chart.setOption(this.chartData)},500)},initCustomConfig(){var t=this.customConfig;for(const e in t)t[e].path.length<6?(1===t[e].path.length&&(this.chartDatas[t[e].path[0]]=t[e].val),2===t[e].path.length&&(this.chartDatas[t[e].path[0]][t[e].path[1]]=t[e].val),3===t[e].path.length&&(this.chartDatas[t[e].path[0]][t[e].path[1]][t[e].path[2]]=t[e].val),4===t[e].path.length&&(this.chartDatas[t[e].path[0]][t[e].path[1]][t[e].path[2]][t[e].path[3]]=t[e].val),5===t[e].path.length&&(this.chartDatas[t[e].path[0]][t[e].path[1]][t[e].path[2]][t[e].path[3]][t[e].path[4]]=t[e].val)):console.log("自定义路径有误")},addData(){this.chartDatas.title.text=this.title,this.chartDatas.xAxis.data=this.chartXData;for(const t in this.yName)this.chartDatas.yAxis[t].name=this.yName[t];for(const t in this.seriesData)this.chartDatas.series[t].name=this.seriesData[t].name,this.chartDatas.series[t].data=this.seriesData[t].data;setTimeout(()=>{this.chart.setOption(this.chartDatas)},300)},clear(){this.chart.clear()},renderAverageItem(t,e){var a=.8*e.size([0,0])[0],i=e.coord([e.value(0),e.value(1)]);return{type:"line",shape:{x1:i[0]-a/2,x2:i[0]+a/2,y1:i[1],y2:i[1]},style:e.style({fill:null,stroke:e.visual("color"),lineWidth:3})}}}},p=g,f=(a("0ee8"),a("2877")),y=Object(f["a"])(p,d,h,!1,null,"4c8798dc",null),D=y.exports,b=a("31ed"),w=a("e50c"),T={name:"TimeSeries",components:{CurrencyForm:o["a"],CurrencyChart:D},props:{idOptions:{type:Array,required:!0}},data(){return{skin:"#666",formData:[{type:"elSelect",variable:"ID",name:"测风塔:",multiple:!1,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,disabled:!0,rules:[{required:!0,message:"请选择测风塔",trigger:"blur"}],emit:"changeCode"},{type:"elSelect",variable:"type",name:"数据类型:",multiple:!1,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择数据类型",trigger:"blur"}],disabled:!0},{type:"elDatePicker",variable:"queryTime",name:"时间:",valueFormat:"yyyy-MM-dd",pickerType:"daterange",colProps:{xl:8,lg:8,md:12,sm:12,xs:24},disabled:!0,required:!0,rules:[{required:!0,message:"请选择时间",trigger:"blur"}],pickerOptions:{}}],formHandle:[{type:"primary",name:"查询",emit:"getData"}],listLoading:!1,title:"",mastListMap:{},mastName:"",channelListMap:{},defaultValue:{},chartXData:[],seriesData:[],customConfig:[],channelList:null,dateRange:[],timer:null,noData:!0}},computed:{chartHeight:()=>document.body.clientHeight-210},watch:{idOptions:{handler:function(t){this.formData[0].data=t.slice()},immediate:!0,deep:!0}},async mounted(){this.$route.query&&this.$route.query.id?(this.defaultValue={ID:this.$route.query.id},await this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)})):window.localStorage.getItem("ATM_CURRENT_TOWER_ID")&&(this.defaultValue={ID:window.localStorage.getItem("ATM_CURRENT_TOWER_ID")},this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)}))},beforeDestroy(){this.timer&&clearInterval(this.timer)},methods:{async getTowerDetail(t){window.localStorage.setItem("ATM_CURRENT_TOWER_ID",t);const e=await Object(b["e"])({ID:t}),a=e.data;this.mastName=a&&a.NAME,a&&a.STARTTIME&&a.ENDTIME?this.dateRange=[a.STARTTIME,a.ENDTIME]:this.dateRange=[]},async getWindTower(){const t=await Object(b["a"])({userType:this.$store.getters.roles,organize:this.$store.getters.organize});if(200===t.code){const e=t&&t.data;this.mastListMap=e,console.log(e),this.formData[0].data=[],Object.keys(e).forEach(t=>{this.formData[0].data.push({label:e[t],value:t})})}},async getChannels(t){this.formData[1].data=[];const e=await Object(w["p"])({ID:t,channelType:1});if(200===e.code){const t=e&&e.data;this.channelListMap=t,Object.keys(t).forEach(e=>{this.formData[1].data.push({label:t[e],value:e})})}},async handleChangeCode(t){this.defaultValue={type:void 0},this.noData=!0;const e=this;await this.getChannels(t.ID),await this.getTowerDetail(t.ID),t.ID&&this.dateRange.length&&this.dateRange[0]&&this.dateRange[1]?(this.formData[1].disabled=!1,this.formData[2].disabled=!1,this.formData[2].pickerOptions={disabledDate(t){return t.getTime()>new Date(e.dateRange[1].split(" ")[0]).getTime()||t.getTime()<new Date(e.dateRange[0].split(" ")[0]).getTime()},shortcuts:[{text:"恢复默认",onClick(t){const a=new Date(e.dateRange[1].split(" ")[0]),i=new Date(e.dateRange[0].split(" ")[0]);t.$emit("pick",[i,a])}}]},this.defaultValue={queryTime:[e.dateRange[0].split(" ")[0],e.dateRange[1].split(" ")[0]]}):(this.defaultValue={queryTime:[]},this.formData[2].disabled=!0)},async getUpidData(t){this.timer&&clearInterval(this.timer),this.timer=setInterval(async()=>{const e=await Object(w["n"])({upid:t}).catch(()=>{this.timer&&clearInterval(this.timer)});if(e&&200===e.code){if("处理失败"===e.data)return this.timer&&clearInterval(this.timer),void this.$message.error("处理失败");"正在查询"===e.data&&this.$message({message:"正在查询",type:"warning",duration:1e3}),e.data&&Object(r["f"])(e.data)&&(this.listLoading=!1,this.noData=!1,this.timer&&clearInterval(this.timer),this.channelList=e.data,this.seriesData=[{name:"时间序列",unit:"",type:"line",smooth:!1,data:this.channelList.seriesData}],this.chartXData=this.channelList.xAxisData,this.timer&&clearInterval(this.timer))}else this.timer&&clearInterval(this.timer)},1e3)},getData(t){if(this.listLoading=!0,!t.ID)return this.$message.error("测风塔选项不允许为空"),void(this.listLoading=!1);this.$refs.currencyForm.$refs.timeSeriesForm.validate(async e=>{if(!e)return this.listLoading=!1,console.log("error submit!!"),!1;{this.title=`时间序列-${this.mastName}-${this.channelListMap[t.type]}`;const e={...t,startDate:t.queryTime[0],endDate:t.queryTime[1]};delete e.queryTime;const a=await Object(w["s"])(e);a&&200===a.code&&(a.data?await this.getUpidData(a.data):(this.listLoading=!1,console.log("timeSeries请求失败",a)))}}),this.customConfig=[{path:["series",0,"barMaxWidth"],val:"50px"}],this.listLoading=!1}}},v=T,x=Object(f["a"])(v,n,l,!1,null,null,null),I=x.exports,C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("CurrencyForm",{ref:"currencyForm",attrs:{"ref-name":"roseForm","form-key":0,"config-data":t.formData,"form-handle":t.formHandle,inline:!1,"set-fields-value":t.defaultValue},on:{changeCode:t.handleChangeCode,getData:t.getData}}),t.noData?t._e():[a("p",{staticStyle:{"text-align":"center"}},[t._v(t._s(t.title))]),a("el-row",{staticStyle:{"flex-wrap":"wrap"},attrs:{gutter:12,type:"flex",justify:"center"}},t._l(t.channelList,(function(e,i){return a("el-col",{key:i,attrs:{span:8}},[a("el-card",{attrs:{shadow:"never"}},[a("rose-chart",{attrs:{"chart-data":e.seriesData,title:e.name,"list-loading":t.listLoading,"chart-x-data":t.chartXData,"save-image":!0}})],1)],1)})),1)]],2)},R=[],_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],style:{height:t.height},attrs:{"element-loading-background":"rgba(150, 150, 150, 0.7)"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.notData,expression:"notData"}],staticStyle:{"text-align":"center"}},[a("svg-icon",{staticClass:"data-icon",attrs:{"icon-class":"notdata"}}),a("p",{staticStyle:{"font-size":"16px",color:"#ccc"}},[t._v("无数据")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.notData,expression:"!notData"}],class:t.className,style:{height:t.height,width:t.width}})])},O=[],S=a("5403");a("817d");var E={mixins:[S["a"]],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"300px"},theme:{type:String,default:""},color:{type:Array,default:function(){return[]}},title:{type:String,default:""},chartData:{type:Array,required:!0},chartXData:{type:Array,required:!0},colorArr:{type:Array,default:function(){return[]}},listLoading:{type:Boolean,default:!1},saveImage:{type:Boolean,default:!1}},data(){return{notData:!1,chart:null,tmpSeries:[],tmpLengendArr:[],tmpObj:{}}},watch:{chartData:{deep:!0,handler(t){0!==t.length?(this.notData=!1,this.setOptions(t)):this.notData=!0}},chartXData:{deep:!0,handler(){this.initChart()}},theme:{handler(t){this.chart&&(this.chart.dispose(),this.initChart())}}},mounted(){this.$nextTick(()=>{this.initChart()})},beforeDestroy(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart(){this.chart=m.a.init(this.$el,this.theme),this.setOptions(this.chartData)},setOptions(t){console.log(t),this.tmpSeries=[],this.tmpLengendArr=[];for(let e=0;e<t.length;e++)this.tmpObj={},this.tmpObj["name"]=this.chartXData[e],this.tmpObj["type"]="bar",this.tmpObj["coordinateSystem"]="polar",this.tmpObj["stack"]="a",this.tmpObj["data"]=t[e],this.tmpSeries.push(this.tmpObj);this.tmpObj={},setTimeout(()=>{this.chart.setOption({title:{x:"center",text:this.title,textStyle:{fontSize:"16",fontWeight:"bold"}},radiusAxis:{axisLabel:{formatter:"{value}%",interval:0},triggerEvent:!0},polar:{center:["50%","50%"],radius:"75%"},legend:{show:!0,type:"scroll",bottom:0,data:this.chartXData},toolbox:{feature:{saveAsImage:this.saveImage&&{title:"下载"}}},angleAxis:{type:"category",data:["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"]},series:this.tmpSeries})},500)}}},L=E,$=Object(f["a"])(L,_,O,!1,null,null,null),q=$.exports,k={name:"DataRose",components:{CurrencyForm:o["a"],RoseChart:q},props:{idOptions:{type:Array,required:!0}},data(){return{skin:"#666",formData:[{type:"elSelect",variable:"ID",name:"测风塔:",multiple:!1,data:[],width:"280px",colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择测风塔",trigger:"blur"}],disabled:!0,emit:"changeCode"},{type:"elSelect",variable:"channel",name:"风速通道:",multiple:!1,data:[],width:"280px",colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择风速通道",trigger:"blur"}]},{type:"elSelect",variable:"channe2",name:"风向通道:",multiple:!1,data:[],width:"280px",colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择风向通道",trigger:"blur"}]},{type:"elDatePicker",variable:"queryTime",name:"时间:",valueFormat:"yyyy-MM-dd",width:"280px",pickerType:"daterange",colProps:{xl:8,lg:8,md:12,sm:12,xs:24},disabled:!0,required:!0,rules:[{required:!0,message:"请选择时间",trigger:"blur"}]},{type:"elRadioGroup",variable:"time",name:"显示模式:",multiple:!1,data:[{label:"年况",value:"年况"},{label:"月况",value:"月况"}],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择显示模式",trigger:"blur"}]},{type:"elRadioGroup",variable:"type",name:"数据类型:",multiple:!1,data:[{label:"风向",value:"风向"},{label:"风能",value:"风能"}],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择数据类型",trigger:"blur"}]}],defaultValue:{},formHandle:[{type:"primary",name:"查询",emit:"getData"}],listLoading:!1,title:"",chartXData:[],seriesData:[],roseDict:{},formParams:{},customConfig:[],upid:"",dateRange:[],channelList:[],timer:null,noData:!0}},watch:{idOptions:{handler:function(t){this.formData[0].data=t.slice()},immediate:!0,deep:!0}},async mounted(){this.$route.query&&this.$route.query.id?(this.defaultValue={ID:this.$route.query.id},await this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)})):window.localStorage.getItem("ATM_CURRENT_TOWER_ID")&&(this.defaultValue={ID:window.localStorage.getItem("ATM_CURRENT_TOWER_ID")},this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)}))},beforeDestroy(){this.timer&&clearInterval(this.timer)},methods:{async getTowerDetail(t){window.localStorage.setItem("ATM_CURRENT_TOWER_ID",t);const e=await Object(b["e"])({ID:t}),a=e.data;a&&a.STARTTIME&&a.ENDTIME?this.dateRange=[a.STARTTIME,a.ENDTIME]:this.dateRange=[]},async getWindTower(){const t=await Object(b["a"])({userType:this.$store.getters.roles,organize:this.$store.getters.organize});if(200===t.code){const e=t&&t.data;console.log(e),this.formData[0].data=[],Object.keys(e).forEach(t=>{this.formData[0].data.push({label:e[t],value:t})})}},async getChannels(t){this.formData[1].data=[];const e=await Object(w["p"])({ID:t,channelType:2});if(200===e.code){const t=e&&e.data;console.log(t),Object.keys(t).forEach(e=>{this.formData[1].data.push({label:t[e],value:e})})}},async getWdChannels(t){this.formData[2].data=[];const e=await Object(w["p"])({ID:t,channelType:3});if(200===e.code){const t=e&&e.data;console.log(t),Object.keys(t).forEach(e=>{this.formData[2].data.push({label:t[e],value:e})})}},async getUpidData(t){this.timer&&clearInterval(this.timer),this.timer=setInterval(async()=>{const e=await Object(w["n"])({upid:t}).catch(()=>{this.timer&&clearInterval(this.timer)});if(e&&200===e.code){if(e.data&&!e.data.res){this.listLoading=!1,this.noData=!1;const t=e.data;"年况"===this.formParams.time&&(this.channelList=[{seriesData:[t.year],name:"年况"}]),"月况"===this.formParams.time&&(this.channelList=[],t.xAxisData.map((e,a)=>{let i={};i.name=e+"月",i.seriesData=[t.seriesData[a]],this.channelList.push(i),i={}})),this.timer&&clearInterval(this.timer)}}else console.log(e,this.timer),this.timer&&clearInterval(this.timer)},5e3)},async getRoseDict(t){const e=await Object(w["l"])({ID:t});if(200===e.code){const t=e&&e.data;this.roseDict=t,this.formData[4].data=[],this.formData[5].data=[],Object.keys(t.time).forEach(e=>{this.formData[4].data.push({label:t.time[e],value:e})}),Object.keys(t.wtype).forEach(e=>{this.formData[5].data.push({label:t.wtype[e],value:e})})}},async handleChangeCode(t){this.defaultValue={channel:void 0,channe2:void 0},this.noData=!0;const e=this;await this.getChannels(t.ID),await this.getWdChannels(t.ID),await this.getTowerDetail(t.ID),this.formData[3].disabled=!1,t.ID&&this.dateRange.length&&this.dateRange[0]&&this.dateRange[1]?(this.formData[3].pickerOptions={disabledDate(t){return t.getTime()>new Date(e.dateRange[1].split(" ")[0]).getTime()||t.getTime()<new Date(e.dateRange[0].split(" ")[0]).getTime()},shortcuts:[{text:"恢复默认",onClick(t){const a=new Date(e.dateRange[1].split(" ")[0]),i=new Date(e.dateRange[0].split(" ")[0]);t.$emit("pick",[i,a])}}]},this.defaultValue={queryTime:[e.dateRange[0].split(" ")[0],e.dateRange[1].split(" ")[0]]}):(this.defaultValue={queryTime:[]},this.formData[3].disabled=!0)},getData(t){if(!t.ID)return this.$message.error("测风塔选项不允许为空"),void(this.listLoading=!1);this.$refs.currencyForm.$refs.roseForm.validate(async e=>{if(!e)return console.log("error submit!!"),!1;{console.log(t);const e={...t,startDate:t.queryTime[0],endDate:t.queryTime[1]};delete e.queryTime,this.formParams=e;const a=e.type;this.title=`${a.substr(0,a.indexOf("m"))}米${e.type}玫瑰图`,this.chartXData=[],this.listLoading=!0;const i=await Object(w["k"])(e);i&&200===i.code&&(i.data?await this.getUpidData(i.data):console.log("请求失败",i))}}),this.customConfig=[{path:["series",0,"barMaxWidth"],val:"50px"}]}}},A=k,j=Object(f["a"])(A,C,R,!1,null,null,null),M=j.exports,V=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("CurrencyForm",{ref:"currencyForm",attrs:{"ref-name":"timeSeriesForm","form-key":0,"config-data":t.formData,"form-handle":t.formHandle,inline:!1,"set-fields-value":t.defaultValue},on:{changeCode:t.handleChangeCode,getData:t.getData}}),t.noData?t._e():[a("p",{staticStyle:{"text-align":"center"}},[t._v(t._s(t.title))]),t.params&&"月况"===t.params.time?a("el-row",{attrs:{gutter:12}},t._l(t.channelList,(function(e,i){return a("el-col",{key:"SpeedAndPowerDensity"+i+t.flag,attrs:{span:12}},[a("el-card",{attrs:{shadow:"never"}},[a("currency-chart",{key:i+t.flag,attrs:{id:"speed-powerdensity-"+(!!e.length&&e[0].name)||!1,title:!!e.length&&e[0].name,"chart-x-data":t.chartXData,"series-data":e,"custom-config":t.customConfig,"list-loading":t.listLoading}})],1)],1)})),1):"年况"===t.params.time?a("currency-chart",{key:"year"+t.flag,attrs:{id:"speed-powerdensity-year",title:t.title,"chart-x-data":t.chartXData,"series-data":t.channelList,"custom-config":t.customConfig,"list-loading":t.listLoading,"is-not-data":t.noData}}):t._e()]],2)},F=[],W={name:"SpeedAndPowerDensity",components:{CurrencyForm:o["a"],CurrencyChart:D},props:{idOptions:{type:Array,required:!0}},data(){return{skin:"#666",formData:[{type:"elSelect",variable:"ID",name:"测风塔:",multiple:!1,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择测风塔",trigger:"blur"}],disabled:!0,emit:"changeCode"},{type:"elSelect",variable:"channel",name:"风速通道:",multiple:!1,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择风速通道",trigger:"blur"}],disabled:!0},{type:"elDatePicker",variable:"queryTime",name:"时间:",valueFormat:"yyyy-MM-dd",pickerType:"daterange",colProps:{xl:8,lg:8,md:12,sm:12,xs:24},disabled:!0,required:!0,rules:[{required:!0,message:"请选择时间",trigger:"blur"}],pickerOptions:{}},{type:"elRadioGroup",variable:"time",name:"显示模式",multiple:!1,data:[{label:"年况",value:"年况"},{label:"月况",value:"月况"}],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择显示模式",trigger:"blur"}]},{type:"elRadioGroup",variable:"wtype",name:"数据类型",multiple:!1,data:[{label:"风速",value:"风速"},{label:"风功率",value:"风功率"}],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择数据类型",trigger:"blur"}]}],defaultValue:{},formHandle:[{type:"primary",name:"查询",emit:"getData"}],listLoading:!1,title:"",params:{time:"",wtype:""},chartXData:[],seriesData:[],customConfig:[],channelList:[],dateRange:[],timer:null,flag:0,noData:!0}},watch:{idOptions:{handler:function(t){this.formData[0].data=t.slice()},immediate:!0,deep:!0}},async mounted(){this.$route.query&&this.$route.query.id?(this.defaultValue={ID:this.$route.query.id},await this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)})):window.localStorage.getItem("ATM_CURRENT_TOWER_ID")&&(this.defaultValue={ID:window.localStorage.getItem("ATM_CURRENT_TOWER_ID")},this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)}))},beforeDestroy(){this.timer&&clearInterval(this.timer)},methods:{async getTowerDetail(t){window.localStorage.setItem("ATM_CURRENT_TOWER_ID",t);const e=await Object(b["e"])({ID:t}),a=e.data;a&&a.STARTTIME&&a.ENDTIME?this.dateRange=[a.STARTTIME,a.ENDTIME]:this.dateRange=[]},async getWindTower(){const t=await Object(b["a"])({userType:this.$store.getters.roles,organize:this.$store.getters.organize});if(200===t.code){const e=t&&t.data;console.log(e),this.formData[0].data=[],Object.keys(e).forEach(t=>{this.formData[0].data.push({label:e[t],value:t})})}},async getChannels(t){this.formData[1].data=[];const e=await Object(w["p"])({ID:t,channelType:2});if(200===e.code){const t=e&&e.data;console.log(t),Object.keys(t).forEach(e=>{this.formData[1].data.push({label:t[e],value:e})})}},async getDataDict(t){const e=await Object(w["a"])({ID:t});if(200===e.code){const t=e&&e.data;this.formData[2].data=[],this.formData[3].data=[],this.formData[4].data=[],Object.keys(t.time).forEach(e=>{this.formData[3].data.push({label:t.time[e],value:e})}),Object.keys(t.wtype).forEach(e=>{this.formData[4].data.push({label:t.wtype[e],value:e})})}},async handleChangeCode(t){this.defaultValue={channel:void 0},this.noData=!0;const e=this;await this.getChannels(t.ID),await this.getTowerDetail(t.ID),t.ID&&this.dateRange.length&&this.dateRange[0]&&this.dateRange[1]?(this.formData[1].disabled=!1,this.formData[2].disabled=!1,this.formData[2].pickerOptions={disabledDate(t){return t.getTime()>new Date(e.dateRange[1].split(" ")[0]).getTime()||t.getTime()<new Date(e.dateRange[0].split(" ")[0]).getTime()},shortcuts:[{text:"恢复默认",onClick(t){const a=new Date(e.dateRange[1].split(" ")[0]),i=new Date(e.dateRange[0].split(" ")[0]);t.$emit("pick",[i,a])}}]},this.defaultValue={queryTime:[e.dateRange[0].split(" ")[0],e.dateRange[1].split(" ")[0]]}):(this.defaultValue={queryTime:[]},this.formData[2].disabled=!0)},async getUpidData(t){const e=this;this.timer&&clearInterval(this.timer),this.timer=setInterval(async()=>{const a=await Object(w["n"])({upid:t}).catch(()=>{this.timer&&clearInterval(this.timer)});if(a&&200===a.code){if("处理失败"===a.data)return this.timer&&clearInterval(this.timer),void this.$message.error("处理失败");if("正在查询"===a.data&&this.$message({message:"正在查询",type:"warning",duration:1e3}),a.data&&Object(r["f"])(a.data)){this.listLoading=!1,this.noData=!1,this.timer&&clearInterval(this.timer);const t=a.data;if(!t||"[object Object]"===toString.call(t)&&0===Object.keys(t).length)return this.channelList=[],void console.log("#kong");if("月况"===this.params.time)console.log("month",t["01"]),this.chartXData=Object.keys(t["01"]).sort((t,e)=>t-e),this.channelList=[],Object.keys(t).sort((t,e)=>t-e).map((e,a)=>{let i={},s=[];i.name=e+"月",i.type="line",i.unit="小时",i.smooth=!1;for(let r=0;r<this.chartXData.length;r++){const a=t[e][this.chartXData[r]]||null;s.push(a)}i.data=s,this.channelList.push([i]),i={},s=[]}),this.flag++;else{this.chartXData=Object.keys(t).sort((t,e)=>t-e);const a=[];this.chartXData.map((e,i)=>{a.push(t[e])}),this.channelList=[{name:"通道",unit:"小时",type:"line",smooth:!1,data:a}],e.flag++}e.flag++}}else this.listLoading=!1,this.timer&&clearInterval(this.timer)},1e3)},getData(t){if(!t.ID)return this.$message.error("测风塔选项不允许为空"),void(this.listLoading=!1);this.$refs.currencyForm.$refs.timeSeriesForm.validate(async e=>{if(!e)return console.log("error submit!!"),!1;{this.title="风速和风功率密度-"+t.time;const e={...t,startDate:t.queryTime[0],endDate:t.queryTime[1]};delete e.queryTime,this.params.time=e.time,this.params.wtype=e.wtype,this.listLoading=!0;const a=await Object(w["m"])(e);a&&200===a.code&&(a.data?await this.getUpidData(a.data):(console.log("speed-power请求失败",a),this.listLoading=!1))}}),this.customConfig=[{path:["series",0,"barMaxWidth"],val:"50px"}]}}},N=W,P=Object(f["a"])(N,V,F,!1,null,null,null),H=P.exports,U=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("CurrencyForm",{ref:"currencyForm",attrs:{"ref-name":"timeSeriesForm","form-key":0,"config-data":t.formData,"form-handle":t.formHandle,inline:!1,"set-fields-value":t.defaultValue},on:{changeCode:t.handleChangeCode,getData:t.getData}}),a("currency-chart",{key:t.flag,attrs:{id:"energy-frequency-chart",title:t.title,"chart-x-data":t.chartXData,"series-data":t.seriesData,"custom-config":t.customConfig,"list-loading":t.listLoading,"is-not-data":t.noData}})],1)},z=[],X={name:"EnergyFrequency",components:{CurrencyForm:o["a"],CurrencyChart:D},props:{idOptions:{type:Array,required:!0}},data(){return{skin:"#666",formData:[{type:"elSelect",variable:"ID",name:"测风塔:",multiple:!1,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择测风塔",trigger:"blur"}],disabled:!0,emit:"changeCode"},{type:"elSelect",variable:"channel",name:"风速通道:",multiple:!1,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择风速通道",trigger:"blur"}],disabled:!0},{type:"elDatePicker",variable:"queryTime",name:"时间:",valueFormat:"yyyy-MM-dd",pickerType:"daterange",colProps:{xl:8,lg:8,md:12,sm:12,xs:24},disabled:!0,required:!0,rules:[{required:!0,message:"请选择时间",trigger:"blur"}],pickerOptions:{}}],defaultValue:{},formHandle:[{type:"primary",name:"查询",emit:"getData"}],listLoading:!1,title:"",chartXData:[],seriesData:[],customConfig:[],channelList:null,dateRange:[],timer:null,noData:!0,flag:0}},watch:{idOptions:{handler:function(t){this.formData[0].data=t.slice()},immediate:!0,deep:!0}},async mounted(){this.$route.query&&this.$route.query.id?(this.defaultValue={ID:this.$route.query.id},await this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)})):window.localStorage.getItem("ATM_CURRENT_TOWER_ID")&&(this.defaultValue={ID:window.localStorage.getItem("ATM_CURRENT_TOWER_ID")},this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)}))},beforeDestroy(){this.timer&&clearInterval(this.timer)},methods:{async getTowerDetail(t){window.localStorage.setItem("ATM_CURRENT_TOWER_ID",t);const e=await Object(b["e"])({ID:t}),a=e.data;a&&a.STARTTIME&&a.ENDTIME?this.dateRange=[a.STARTTIME,a.ENDTIME]:this.dateRange=[]},async getWindTower(){const t=await Object(b["a"])({userType:this.$store.getters.roles,organize:this.$store.getters.organize});if(200===t.code){const e=t&&t.data;console.log(e),this.formData[0].data=[],Object.keys(e).forEach(t=>{this.formData[0].data.push({label:e[t],value:t})})}},async getChannels(t){this.formData[1].data=[];const e=await Object(w["p"])({ID:t,channelType:2});if(200===e.code){const t=e&&e.data;console.log(t),Object.keys(t).forEach(e=>{this.formData[1].data.push({label:t[e],value:e})})}},async handleChangeCode(t){this.defaultValue={channel:void 0},this.noData=!0;const e=this;await this.getChannels(t.ID),await this.getTowerDetail(t.ID),t.ID&&this.dateRange.length&&this.dateRange[0]&&this.dateRange[1]?(this.formData[1].disabled=!1,this.formData[2].disabled=!1,this.formData[2].pickerOptions={disabledDate(t){return t.getTime()>new Date(e.dateRange[1].split(" ")[0]).getTime()||t.getTime()<new Date(e.dateRange[0].split(" ")[0]).getTime()},shortcuts:[{text:"恢复默认",onClick(t){const a=new Date(e.dateRange[1].split(" ")[0]),i=new Date(e.dateRange[0].split(" ")[0]);t.$emit("pick",[i,a])}}]},this.defaultValue={queryTime:[e.dateRange[0].split(" ")[0],e.dateRange[1].split(" ")[0]]}):(this.defaultValue={queryTime:[]},this.formData[2].disabled=!0)},async getUpidData(t){this.timer&&clearInterval(this.timer),this.timer=setInterval(async()=>{const e=await Object(w["n"])({upid:t}).catch(()=>{this.timer&&clearInterval(this.timer)});if(e&&200===e.code){if(e.data&&!e.data.res){if(this.listLoading=!1,this.timer&&clearInterval(this.timer),console.log(e.data),this.channelList=e.data,!this.channelList||!Object.keys(this.channelList).includes("wind")||!this.channelList["wind"].seriesData.length)return void(this.seriesData=[]);this.noData=!1,console.log(this.channelList),this.seriesData=[{name:"风速",unit:"频率%",type:"bar",smooth:!1,data:this.channelList["wind"].seriesData},{name:"风能",unit:"频率%",type:"bar",smooth:!1,data:this.channelList["WPD"].seriesData}],this.chartXData=this.channelList["wind"].xAxisData,this.flag++}}else this.listLoading=!1,this.timer&&clearInterval(this.timer)},1e3)},getData(t){if(!t.ID)return this.$message.error("测风塔选项不允许为空"),void(this.listLoading=!1);this.$refs.currencyForm.$refs.timeSeriesForm.validate(async e=>{if(!e)return console.log("error submit!!"),!1;{const e={...t,startDate:t.queryTime[0],endDate:t.queryTime[1]};delete e.queryTime,this.listLoading=!0;const a=await Object(w["j"])(e);a&&200===a.code&&(a.data?await this.getUpidData(a.data):(console.log("timeSeries请求失败",a),this.listLoading=!1))}}),this.listLoading=!0,this.title="风速风能频率直方图",this.customConfig=[{path:["series",0,"barMaxWidth"],val:"50px"}]}}},B=X,G=Object(f["a"])(B,U,z,!1,null,null,null),Y=G.exports,J=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("CurrencyForm",{ref:"currencyForm",attrs:{"ref-name":"timeSeriesForm","form-key":0,"config-data":t.formData,"form-handle":t.formHandle,inline:!1,"set-fields-value":t.defaultValue},on:{changeCode:t.handleChangeCode,getData:t.getData}}),a("currency-chart",{attrs:{id:"weibull-chart",title:t.title,"chart-x-data":t.chartXData,"series-data":t.seriesData,"custom-config":t.customConfig,"list-loading":t.listLoading,height:t.chartHeight+"px","is-not-data":t.noData}})],1)},Z=[],K={name:"SpeedAndPowerDensity",components:{CurrencyForm:o["a"],CurrencyChart:D},props:{idOptions:{type:Array,required:!0}},data(){return{skin:"#666",formData:[{type:"elSelect",variable:"ID",name:"测风塔:",multiple:!1,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择测风塔",trigger:"blur"}],disabled:!0,emit:"changeCode"},{type:"elSelect",variable:"channel",name:"风速通道:",multiple:!1,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择风速通道",trigger:"blur"}],disabled:!0},{type:"elDatePicker",variable:"queryTime",name:"时间:",valueFormat:"yyyy-MM-dd",pickerType:"daterange",colProps:{xl:8,lg:8,md:12,sm:12,xs:24},width:"300px",disabled:!0,required:!0,rules:[{required:!0,message:"请选择时间",trigger:"blur"}],pickerOptions:{}}],defaultValue:{},formHandle:[{type:"primary",name:"查询",emit:"getData"}],listLoading:!1,title:"",chartXData:[],seriesData:[],customConfig:[],channelList:null,dateRange:[],timer:null,noData:!0}},computed:{chartHeight:()=>document.body.clientHeight-210},watch:{idOptions:{handler:function(t){this.formData[0].data=t.slice()},immediate:!0,deep:!0}},async mounted(){this.$route.query&&this.$route.query.id?(this.defaultValue={ID:this.$route.query.id},await this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)})):window.localStorage.getItem("ATM_CURRENT_TOWER_ID")&&(this.defaultValue={ID:window.localStorage.getItem("ATM_CURRENT_TOWER_ID")},this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)}))},beforeDestroy(){this.timer&&clearInterval(this.timer)},methods:{async getTowerDetail(t){window.localStorage.setItem("ATM_CURRENT_TOWER_ID",t);const e=await Object(b["e"])({ID:t}),a=e.data;a&&a.STARTTIME&&a.ENDTIME?this.dateRange=[a.STARTTIME,a.ENDTIME]:this.dateRange=[]},async getWindTower(){const t=await Object(b["a"])({userType:this.$store.getters.roles,organize:this.$store.getters.organize});if(200===t.code){const e=t&&t.data;console.log(e),this.formData[0].data=[],Object.keys(e).forEach(t=>{this.formData[0].data.push({label:e[t],value:t})})}},async getChannels(t){this.formData[1].data=[];const e=await Object(w["p"])({ID:t,channelType:2});if(200===e.code){const t=e&&e.data;console.log(t),Object.keys(t).forEach(e=>{this.formData[1].data.push({label:t[e],value:e})})}},async getDataDict(t){const e=await Object(w["a"])({ID:t});if(200===e.code){const t=e&&e.data;this.formData[1].data=[],this.formData[2].data=[],Object.keys(t.channel).forEach(e=>{this.formData[1].data.push({label:t.channel[e],value:e})})}},async handleChangeCode(t){this.defaultValue={channel:void 0},this.noData=!0;const e=this;await this.getChannels(t.ID),await this.getTowerDetail(t.ID),t.ID&&this.dateRange.length&&this.dateRange[0]&&this.dateRange[1]?(this.formData[1].disabled=!1,this.formData[2].disabled=!1,this.formData[2].pickerOptions={disabledDate(t){return t.getTime()>new Date(e.dateRange[1].split(" ")[0]).getTime()||t.getTime()<new Date(e.dateRange[0].split(" ")[0]).getTime()},shortcuts:[{text:"恢复默认",onClick(t){const a=new Date(e.dateRange[1].split(" ")[0]),i=new Date(e.dateRange[0].split(" ")[0]);t.$emit("pick",[i,a])}}]},this.defaultValue={queryTime:[e.dateRange[0].split(" ")[0],e.dateRange[1].split(" ")[0]]}):(this.defaultValue={queryTime:[]},this.formData[2].disabled=!0)},async getUpidData(t){this.timer&&clearInterval(this.timer),this.timer=setInterval(async()=>{const e=await Object(w["n"])({upid:t}).catch(()=>{this.timer&&clearInterval(this.timer)});e&&200===e.code?e.data&&!e.data.res&&(this.noData=!1,this.channelList=e.data,this.seriesData=[{name:"实测值",unit:"%",type:"bar",smooth:!1,data:this.channelList.weibull_bin.bin},{name:`极大似然 k-${this.channelList.k} c-${this.channelList.c}`,unit:"%",type:"line",smooth:!1,data:this.channelList.pdf_curve.curve}],this.chartXData=this.channelList.weibull_bin.wind,this.listLoading=!1,this.timer&&clearInterval(this.timer),this.customConfig=[{path:["series",1,"tooltip"],val:{formatter:""}}]):this.timer&&clearInterval(this.timer)},1e3)},getData(t){if(!t.ID)return this.$message.error("测风塔选项不允许为空"),void(this.listLoading=!1);this.$refs.currencyForm.$refs.timeSeriesForm.validate(async e=>{if(!e)return console.log("error submit!!"),!1;{const e={...t,startDate:t.queryTime[0],endDate:t.queryTime[1]};delete e.queryTime,this.listLoading=!0;const a=await Object(w["i"])(e);a&&200===a.code&&(a.data?await this.getUpidData(a.data):(console.log("请求失败",a),this.listLoading=!1))}}),this.listLoading=!0,this.title="威布尔分析",this.listLoading=!1}}},Q=K,tt=Object(f["a"])(Q,J,Z,!1,null,null,null),et=tt.exports,at=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("CurrencyForm",{ref:"currencyForm",attrs:{"ref-name":"dataAnalysisForm","form-key":0,"config-data":t.formData,"form-handle":t.formHandle,inline:!1,"set-fields-value":t.defaultValue},on:{changeCode:t.handleChangeCode,getData:t.getData}}),t.noData?t._e():[t.tableData&&t.tableData.length?a("el-table",{ref:"shearTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark",border:""}},t._l(t.columns,(function(e){return a("el-table-column",{key:e.dataIndex,attrs:{label:e.title},scopedSlots:t._u([{key:"default",fn:function(i){return[a("span",[t._v(t._s(i.row[e.dataIndex]))])]}}],null,!0)},[t._v("\n        "+t._s(e.dataIndex)+"\n        ")])})),1):t._e(),t.seriesData?a("LineMarker",{attrs:{id:"shear-chart",title:t.title,width:"calc(100vw - 310px)","chart-data":t.seriesData,"custom-config":t.customConfig,"list-loading":t.listLoading}}):t._e()]],2)},it=[],st=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.className,style:{height:t.height,width:t.width},attrs:{id:t.id}})},rt=[],nt=a("2f62");a("817d");var lt={mixins:[u],props:{className:{type:String,default:"chart"},id:{type:String,default:"chart"},width:{type:String,default:"200px"},height:{type:String,default:"400px"},title:{type:String,default:""},theme:{type:String,default:"macarons"},autoResize:{type:Boolean,default:!0},chartData:{type:Object,required:!0}},data(){return{chart:null,newTitle:"",tmpLengendArr:[],tmpSeries:[]}},computed:{...Object(nt["b"])(["currStationPathId","themeName"])},watch:{chartData:{deep:!0,handler(t){this.setOptions(t)}},title:{deep:!0,handler(t){this.newTitle=t,this.setOptions(this.chartData)}},theme:{handler(t){this.chart&&(this.chart.dispose(),this.initChart())}}},mounted(){this.$nextTick(()=>{this.initChart()})},beforeDestroy(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart(){this.newTitle=this.title,this.chart=m.a.init(this.$el,this.theme),this.setOptions(this.chartData)},setOptions(t){this.chart.clear(),this.tmpLengendArr=[];let e=[];e=this.setSeriesType(t),this.chart.setOption({title:{top:20,text:this.newTitle,textStyle:{fontWeight:"normal",fontSize:16},left:"1%"},tooltip:{trigger:"axis",axisPointer:{lineStyle:{}},tooltip:{formatter:"{b}<br />x: {c0}<br />y: {c1}"}},legend:{type:"scroll",pageIconColor:"light"===this.themeName?"#000":"#fff",pageIconInactiveColor:"#ccc",pageTextStyle:{color:"light"===this.themeName?"#000":"#fff"},top:50,icon:"rect",itemWidth:14,itemHeight:5,itemGap:13,data:this.tmpLengendArr,right:"4%",textStyle:{fontSize:12}},grid:{top:100,left:"2%",right:60,bottom:70,containLabel:!0},dataZoom:[{type:"slider",show:!0,xAxisIndex:[0],bottom:24},{type:"inside",xAxisIndex:[0],start:1,end:35}],xAxis:[{type:"value",axisLabel:{formatter:"{value}m/s",interval:0},nameTextStyle:{color:"#F1F1F3"},axisLine:{lineStyle:{color:"#88898b"}},splitLine:{lineStyle:{color:"#88898b"}}}],yAxis:[{type:"value",name:"(m)",axisTick:{show:!1},nameTextStyle:{},axisLine:{lineStyle:{color:"#88898b"}},axisLabel:{margin:10,textStyle:{fontSize:14}},splitLine:{lineStyle:{color:"#88898b"}}}],series:e})},setSeriesType(t){var e=t.type,a=t.line,i=t.scatter,s=t.corrected;const r=[];if(this.tmpLengendArr=[],null!=a&&void 0!==a)for(let n=0;n<a.length;n++){this.tmpLengendArr.push(a[n].key+a[n].name);const t={type:"line",symbol:"none",tooltip:{show:!1}};t["name"]=a[n].key+a[n].name,t["data"]=a[n].value,r.push(t)}if(s)for(let n=0;n<s.length;n++){this.tmpLengendArr.push(s[n].key+s[n].name);const t={type:"line"};t["name"]=s[n].key+s[n].name,t["data"]=s[n].speedPower,r.push(t)}if(null!==i||void 0!==i)for(let n=0;n<i.length;n++)if(this.tmpLengendArr.push(i[n].name),""===i[n].key){const t={type:"line"};t["name"]=i[n].name,t["data"]=i[n].value,r.push(t)}else if("scatter"===e){const t={type:"scatter",symbolSize:6,tooltip:{formatter:"{b}<br />x: {c0}<br />y: {c1}"}};this.tmpLengendArr.push(i[n].key+i[n].name),t["name"]=i[n].key+i[n].name,t["data"]=i[n].value,r.push(t),console.log(r)}return r}}},ot=lt,dt=Object(f["a"])(ot,st,rt,!1,null,null,null),ht=dt.exports,ct={name:"Shear",components:{CurrencyForm:o["a"],LineMarker:ht},props:{idOptions:{type:Array,required:!0}},data(){return{formData:[{type:"elSelect",variable:"ID",name:"测风塔:",multiple:!1,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择测风塔",trigger:"blur"}],disabled:!0,emit:"changeCode"},{type:"elDatePicker",variable:"queryTime",name:"时间:",valueFormat:"yyyy-MM-dd",pickerType:"daterange",width:"240px",colProps:{xl:8,lg:8,md:12,sm:12,xs:24},disabled:!0,pickerOptions:{},rules:[{required:!0,message:"请选择时间",trigger:["blur","change"]}]},{type:"elSelect",variable:"height",name:"高度层:",multiple:!0,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},disabled:!0,rules:[{required:!0,message:"请选择高度层",trigger:["blur","change"]}]}],defaultValue:{},formHandle:[{type:"primary",name:"查询",emit:"getData",loading:!1}],listLoading:!1,title:"",chartXData:[],seriesData:null,customConfig:[],channelList:null,dateRange:[],timer:null,heightData:[],columns:[],tableData:[],noData:!0}},watch:{idOptions:{handler:function(t){this.formData[0].data=t.slice()},immediate:!0,deep:!0}},async mounted(){this.$route.query&&this.$route.query.id?(this.defaultValue={ID:this.$route.query.id},await this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)})):window.localStorage.getItem("ATM_CURRENT_TOWER_ID")&&(this.defaultValue={ID:window.localStorage.getItem("ATM_CURRENT_TOWER_ID")},this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)}))},beforeDestroy(){this.timer&&clearInterval(this.timer)},methods:{async getTowerDetail(t){window.localStorage.setItem("ATM_CURRENT_TOWER_ID",t);const e=await Object(b["e"])({ID:t}),a=e.data;a&&a.STARTTIME&&a.ENDTIME?this.dateRange=[a.STARTTIME,a.ENDTIME]:this.dateRange=[]},async getWindTower(){const t=await Object(b["a"])({userType:this.$store.getters.roles,organize:this.$store.getters.organize});if(200===t.code){const e=t&&t.data;console.log(e),this.formData[0].data=[],Object.keys(e).forEach(t=>{this.formData[0].data.push({label:e[t],value:t})})}},async getChannels(t){const e=await Object(w["d"])({ID:t});if(200===e.code){const t=e&&e.data;console.log(t),this.formData[1].data=[],Object.keys(t).forEach(e=>{this.formData[1].data.push({label:t[e],value:e})})}},async getDataDict(t){const e=await Object(w["a"])({ID:t});if(200===e.code){const t=e&&e.data;this.formData[1].data=[],Object.keys(t.channel).forEach(e=>{this.formData[1].data.push({label:t.channel[e],value:e})})}},async getHeightDict(t){const e=await Object(w["p"])({ID:t,channelType:4});if(200===e.code){this.formData[2].data=[],this.formData[2].disabled=!1;const t=e.data&&e.data.height;t.split(",").map(t=>{this.formData[2].data.push({label:t+"米",value:t})})}},async handleChangeCode(t){this.noData=!0;const e=this;this.defaultValue={height:void 0,queryTime:[]},await this.getHeightDict(t.ID),await this.getTowerDetail(t.ID),t.ID&&this.dateRange.length&&this.dateRange[0]&&this.dateRange[1]?(this.formData[1].disabled=!1,this.formData[1].pickerOptions={disabledDate(t){return t.getTime()>new Date(e.dateRange[1].split(" ")[0]).getTime()||t.getTime()<new Date(e.dateRange[0].split(" ")[0]).getTime()},shortcuts:[{text:"恢复默认",onClick(t){const a=new Date(e.dateRange[1].split(" ")[0]),i=new Date(e.dateRange[0].split(" ")[0]);t.$emit("pick",[i,a])}}]},this.defaultValue={queryTime:[e.dateRange[0].split(" ")[0],e.dateRange[1].split(" ")[0]]}):(this.defaultValue={queryTime:[]},this.formData[1].disabled=!0)},async getUpidData(t){this.timer&&clearInterval(this.timer),this.timer=setInterval(async()=>{const e=await Object(w["n"])({upid:t}).catch(()=>{this.timer&&clearInterval(this.timer)});if(e&&200===e.code){if("处理失败"===e.data)return this.timer&&clearInterval(this.timer),this.listLoading=!1,this.formHandle[0].loading=!1,void this.$message.error("处理失败");if("正在查询"===e.data&&this.$message({message:"正在查询",type:"warning",duration:1e3}),e.data&&Object(r["f"])(e.data)){this.listLoading=!1,this.noData=!1,this.formHandle[0].loading=!1,this.channelList=e.data,this.tableData=this.channelList.shear_ceng;const t=[],a=[],i=Math.min(...this.channelList.wind),s=Math.max(...this.channelList.wind);console.log(s);for(let e=0;e<i;e+=.1)t.push([e.toFixed(1),this.channelList.c*Math.pow(e.toFixed(1),this.channelList.a)]);this.channelList.wind&&this.channelList.wind.map((e,i)=>{t.push([e,this.channelList.c*Math.pow(e,this.channelList.a)]),a.push([e,this.channelList["height"][i]])});for(let e=s+.1;e<s+.5;e+=.1)t.push([e.toFixed(1),this.channelList.c*Math.pow(e.toFixed(1),this.channelList.a)]);this.seriesData={line:[{name:`拟合曲线 y=c*x^a, c=${this.channelList.c}, a=${this.channelList.a}`,key:"风切变",value:t}],scatter:[{name:"实测值",key:"scatter",value:a}],corrected:[],type:"scatter"},this.chartXData=this.channelList.height,this.title="风切变拟合曲线",this.listLoading=!1,this.formHandle[0].loading=!1,this.timer&&clearInterval(this.timer)}}else this.timer&&clearInterval(this.timer)},1e3)},getData(t){if(!t.ID)return this.$message.error("测风塔选项不允许为空"),this.listLoading=!1,void(this.formHandle[0].loading=!1);this.$refs.currencyForm.$refs.dataAnalysisForm.validate(async e=>{if(!e)return console.log("error submit!!"),!1;{const e={...t,startDate:t.queryTime[0],endDate:t.queryTime[1],height:t.height.join(",")};delete e.queryTime,this.listLoading=!0,this.formHandle[0].loading=!0,this.columns=[],this.columns.push({title:"风切变",dataIndex:"height"}),t.height.sort((t,e)=>e-t).map((e,a)=>{a<t.height.length-1&&this.columns.push({title:e+"米",dataIndex:e})});const a=await Object(w["g"])(e);a&&200===a.code&&(a.data?await this.getUpidData(a.data):(console.log("shear请求失败",a),this.listLoading=!1,this.formHandle[0].loading=!1))}}),this.title="风切变分析",this.customConfig=[{path:["series",0,"barMaxWidth"],val:"50px"}]}}},mt=ct,ut=Object(f["a"])(mt,at,it,!1,null,null,null),gt=ut.exports,pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("CurrencyForm",{ref:"currencyForm",attrs:{"ref-name":"dataAnalysisForm","form-key":0,"config-data":t.formData,"form-handle":t.formHandle,inline:!1,"set-fields-value":t.defaultValue},on:{changeCode:t.handleChangeCode,changeType:t.handleChangeType,getData:t.getData,toggle:t.handleToggle}}),t.channelList&&t.channelList.length&&!t.noData?a("el-table",{directives:[{name:"show",rawName:"v-show",value:t.toggleShow,expression:"toggleShow"}],key:t.flag,staticStyle:{width:"100%"},attrs:{data:t.channelList}},t._l(t.columns,(function(e){return a("el-table-column",{key:e.dataIndex,attrs:{label:e.title},scopedSlots:t._u([{key:"default",fn:function(i){return[a("span",[t._v(t._s(i.row[e.dataIndex]))])]}}],null,!0)},[t._v("\n      "+t._s(e.dataIndex)+"\n      ")])})),1):t._e(),["HIGH","WS"].includes(t.dType.toUpperCase())?a("currency-chart",{style:{width:"100%",opacity:t.toggleShow?0:1},attrs:{id:"turbulence-"+t.dType+"-chart",title:t.title,"chart-x-data":t.chartXData,"series-data":t.seriesData,"custom-config":t.customConfig,"list-loading":t.listLoading,"is-not-data":t.noData}}):t._e()],1)},ft=[],yt={name:"Turbulence",components:{CurrencyForm:o["a"],CurrencyChart:D},props:{idOptions:{type:Array,required:!0}},data(){return{skin:"#666",formData:[{type:"elSelect",variable:"ID",name:"测风塔:",multiple:!1,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择测风塔",trigger:"blur"}],disabled:!0,emit:"changeCode"},{type:"elSelect",variable:"channel",name:"风速通道:",multiple:!1,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择风速通道",trigger:"blur"}],disabled:!0},{type:"elDatePicker",variable:"queryTime",name:"时间:",valueFormat:"yyyy-MM-dd",pickerType:"daterange",colProps:{xl:8,lg:8,md:12,sm:12,xs:24},disabled:!0,required:!0,rules:[{required:!0,message:"请选择时间",trigger:"blur"}],pickerOptions:{}}],defaultValue:{},formHandle:[{type:"primary",name:"查询",emit:"getData"},{type:"primary",name:"切换",disabled:!0,emit:"toggle"}],listLoading:!1,title:"",chartXData:[],seriesData:[],customConfig:[],channelList:[],dateRange:[],timer:null,dType:"",columns:[],flag:0,toggleShow:!0,ifHaveChart:!0,noData:!0}},watch:{idOptions:{handler:function(t){this.formData[0].data=t.slice()},immediate:!0,deep:!0}},async mounted(){this.$route.query&&this.$route.query.id?(this.defaultValue={ID:this.$route.query.id},await this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)})):window.localStorage.getItem("ATM_CURRENT_TOWER_ID")&&(this.defaultValue={ID:window.localStorage.getItem("ATM_CURRENT_TOWER_ID")},this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)}))},beforeDestroy(){this.timer&&clearInterval(this.timer)},methods:{async getTowerDetail(t){window.localStorage.setItem("ATM_CURRENT_TOWER_ID",t);const e=await Object(b["e"])({ID:t}),a=e.data;a&&a.STARTTIME&&a.ENDTIME?this.dateRange=[a.STARTTIME,a.ENDTIME]:this.dateRange=[]},async getWindTower(){const t=await Object(b["a"])({userType:this.$store.getters.roles,organize:this.$store.getters.organize});if(200===t.code){const e=t&&t.data;console.log(e),this.formData[0].data=[],Object.keys(e).forEach(t=>{this.formData[0].data.push({label:e[t],value:t})})}},async getChannels(t){this.formData[1].data=[];const e=await Object(w["p"])({ID:t,channelType:2});if(200===e.code){const t=e&&e.data;console.log(t),Object.keys(t).forEach(e=>{this.formData[1].data.push({label:t[e],value:e})})}},async getDataDict(t){const e=await Object(w["t"])({ID:t});if(200===e.code){e&&e.data;this.formData[2].data=[]}},async handleChangeCode(t){this.defaultValue={channel:void 0},this.noData=!0;const e=this;await this.getChannels(t.ID),await this.getTowerDetail(t.ID),t.ID&&this.dateRange.length&&this.dateRange[0]&&this.dateRange[1]?(this.formData[1].disabled=!1,this.formData[2].disabled=!1,this.formData[2].pickerOptions={disabledDate(t){return t.getTime()>new Date(e.dateRange[1].split(" ")[0]).getTime()||t.getTime()<new Date(e.dateRange[0].split(" ")[0]).getTime()},shortcuts:[{text:"恢复默认",onClick(t){const a=new Date(e.dateRange[1].split(" ")[0]),i=new Date(e.dateRange[0].split(" ")[0]);t.$emit("pick",[i,a])}}]},this.defaultValue={queryTime:[e.dateRange[0].split(" ")[0],e.dateRange[1].split(" ")[0]]}):(this.defaultValue={queryTime:[]},this.formData[2].disabled=!0)},async handleChangeType(t){},async getUpidData(t){this.timer&&clearInterval(this.timer),this.timer=setInterval(async()=>{const e=await Object(w["n"])({upid:t}).catch(()=>{this.timer&&clearInterval(this.timer)});if(this.chartXData=[],this.channelList=[],console.log(this.chartXData,this.channelList),e&&200===e.code){if(e.data&&!e.data.res){this.listLoading=!1,this.noData=!1,this.timer&&clearInterval(this.timer);const t=e.data,a=t&&Object.keys(t),i=Object.keys(t).filter(t=>"line"!==t).sort((t,e)=>t-e);for(let e=0;e<i.length;e++)"DAY"===this.dType.toUpperCase()&&(this.ifHaveChart=!1,this.columns=[{title:"时间",dataIndex:"Hour"},{title:"统计数据点",dataIndex:"Data_Points"},{title:"平均湍流",dataIndex:"Mean_TI"},{title:"湍流标准差",dataIndex:"Peak_TI"},{title:"代表湍流",dataIndex:"Representative_TI"},{title:"湍流峰值",dataIndex:"Standard_Deviation_of_TI"}],this.channelList.push({...t[i[e]],Hour:i[e]}),this.flag++),"HIGH"===this.dType.toUpperCase()&&(this.ifHaveChart=!0,this.formHandle[1].disabled=!1,this.columns=[{title:"测量高度",dataIndex:"Height"},{title:"统计数据点",dataIndex:"Data_Points"},{title:"平均湍流",dataIndex:"Mean_TI"},{title:"湍流标准差",dataIndex:"Standard_Deviation_of_TI"},{title:"代表湍流",dataIndex:"Representative_TI"},{title:"湍流峰值",dataIndex:"Peak_TI"},{title:"15m/s风速段统计数据点",dataIndex:"Data_Points_15m/s"},{title:"15m/s风速段平均湍流",dataIndex:"Mean_TI_15m/s"},{title:"15m/s风速段湍流标准差",dataIndex:"Standard_Deviation_of_TI_15m/s"},{title:"15m/s风速段代表湍流",dataIndex:"Representative_TI_15m/s"},{title:"15m/s风速段湍流IEC分级",dataIndex:"IEC_3ed_Turbulence_Category_15m/s"}],this.channelList.push({...t[i[e]],Height:i[e]}),a.includes("line")&&!this.chartXData.length&&(this.seriesData=[{name:"Mean_Turbulence_Intensity",unit:"",type:"line",smooth:!1,data:t["line"].Mean_Turbulence_Intensity}],this.chartXData=t["line"].Height_Above_Ground,this.title="Mean Turbulence Intensity vs Height"),this.flag++),"WS"===this.dType.toUpperCase()&&(this.ifHaveChart=!0,this.formHandle[1].disabled=!1,this.columns=[{title:"序号",dataIndex:"Bin"},{title:"风速段中间值",dataIndex:"Bin_Midpoint"},{title:"风速段下限",dataIndex:"Bin_Endpoint_Lower"},{title:"风速段上限",dataIndex:"Bin_Endpoint_Upper"},{title:"统计数据点",dataIndex:"Data_Points"},{title:"数量量占比",dataIndex:"Bin_Frequency"},{title:"平均湍流",dataIndex:"Mean_TI"},{title:"湍流标准差",dataIndex:"Standard_Deviation_of_TI"},{title:"代表湍流",dataIndex:"Representative_TI"},{title:"湍流峰值",dataIndex:"Peak_TI"}],this.channelList.push({...t[i[e]],Bin:i[e]}),a.includes("line")&&!this.chartXData.length&&(this.seriesData=[{name:"Mean_TI",unit:"m/s",type:"line",smooth:!1,data:t["line"].Mean_TI},{name:"Repressentative_TI",unit:"m/s",type:"line",smooth:!1,data:t["line"].Repressentative_TI}],this.chartXData=t["line"].Wind_Speed,this.title="Turbulence Intensityvs Wind Speed for Speed 80 m A"),this.flag++),"MONTH"===this.dType.toUpperCase()&&(this.ifHaveChart=!1,this.formHandle[1].disabled=!0,this.columns=[{title:"月份",dataIndex:"Month"},{title:"统计数据点",dataIndex:"Data_Points"},{title:"平均湍流",dataIndex:"Mean_TI"},{title:"湍流标准差",dataIndex:"Peak_TI"},{title:"代表湍流",dataIndex:"Representative_TI"},{title:"湍流峰值",dataIndex:"Standard_Deviation_of_TI"}],this.channelList.push({...t[i[e]],Month:i[e]+"月"}),this.flag++),"WD"===this.dType.toUpperCase()&&(this.ifHaveChart=!1,this.formHandle[1].disabled=!0,this.columns=[{title:"扇区",dataIndex:"Sector"},{title:"扇区中间值",dataIndex:"Sector_Midpoint"},{title:"扇区范围",dataIndex:"Sector_Range"},{title:"统计数据点",dataIndex:"Data_Points"},{title:"平均湍流",dataIndex:"Mean_TI"},{title:"湍流标准差",dataIndex:"Peak_TI"},{title:"代表湍流",dataIndex:"Representative_TI"},{title:"湍流峰值",dataIndex:"Standard_Deviation_of_TI"}],this.channelList.push({...t[i[e]],Sector:i[e]}),this.flag++)}}else this.timer&&clearInterval(this.timer)},1e3)},handleToggle(){this.toggleShow=!this.toggleShow,this.flag++},getData(t){if(!t.ID)return this.$message.error("测风塔选项不允许为空"),void(this.listLoading=!1);this.$refs.currencyForm.$refs.dataAnalysisForm.validate(async e=>{if(!e)return console.log("error submit!!"),!1;{const e={...t,startDate:t.queryTime[0],endDate:t.queryTime[1],dtype:"WS"};delete e.queryTime,this.dType=e.dtype,this.listLoading=!0;const a=await Object(w["h"])(e);a&&200===a.code&&(a.data?await this.getUpidData(a.data):(console.log("timeSeries请求失败",a),this.listLoading=!1))}}),this.listLoading=!0,this.customConfig=[{path:["series",0,"barMaxWidth"],val:"50px"}],this.listLoading=!1}}},Dt=yt,bt=Object(f["a"])(Dt,pt,ft,!1,null,null,null),wt=bt.exports,Tt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("CurrencyForm",{ref:"currencyForm",attrs:{"ref-name":"timeSeriesForm","form-key":0,"config-data":t.formData,"form-handle":t.formHandle,"set-fields-value":t.defaultValue,inline:!1},on:{changeCode:t.handleChangeCode,getData:t.getData}}),a("p",{directives:[{name:"show",rawName:"v-show",value:!t.noData,expression:"!noData"}],staticStyle:{"text-align":"center"}},[t._v(t._s(t.title)+" "+t._s(t.seriesData))])],1)},vt=[],xt={name:"MaximumSpeed50years",components:{CurrencyForm:o["a"]},props:{idOptions:{type:Array,required:!0}},data(){return{skin:"#666",formData:[{type:"elSelect",variable:"ID",name:"测风塔:",multiple:!1,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择测风塔",trigger:"blur"}],disabled:!0,emit:"changeCode"},{type:"elSelect",variable:"channel",name:"数据类型:",multiple:!1,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择数据类型",trigger:"blur"}],disabled:!0},{type:"elDatePicker",variable:"queryTime",name:"时间:",valueFormat:"yyyy-MM-dd",pickerType:"daterange",colProps:{xl:8,lg:8,md:12,sm:12,xs:24},disabled:!0,required:!0,rules:[{required:!0,message:"请选择时间",trigger:"blur"}],pickerOptions:{}},{type:"elSelect",variable:"analysisType",name:"分析类型:",multiple:!1,data:[{label:"五日雷暴法",value:1},{label:"EWTS II法",value:2}],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择分析类型",trigger:"blur"}]}],defaultValue:{ID:""},formHandle:[{type:"primary",name:"查询",emit:"getData"}],listLoading:!1,title:"",channelMap:{},chartXData:[],seriesData:"",customConfig:[],channelList:null,dateRange:[],timer:null,formParams:{},noData:!0}},watch:{idOptions:{handler:function(t){this.formData[0].data=t.slice()},immediate:!0,deep:!0}},async mounted(){this.$route.query&&this.$route.query.id?(this.defaultValue={ID:this.$route.query.id},await this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)})):window.localStorage.getItem("ATM_CURRENT_TOWER_ID")&&(this.defaultValue={ID:window.localStorage.getItem("ATM_CURRENT_TOWER_ID")},this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)}))},beforeDestroy(){this.timer&&clearInterval(this.timer)},methods:{async getTowerDetail(t){window.localStorage.setItem("ATM_CURRENT_TOWER_ID",t);const e=await Object(b["e"])({ID:t}),a=e.data;a&&a.STARTTIME&&a.ENDTIME?this.dateRange=[a.STARTTIME,a.ENDTIME]:this.dateRange=[]},async getWindTower(){const t=await Object(b["a"])({userType:this.$store.getters.roles,organize:this.$store.getters.organize});if(200===t.code){const e=t&&t.data;console.log(e),this.formData[0].data=[],Object.keys(e).forEach(t=>{this.formData[0].data.push({label:e[t],value:t})})}},async getChannels(t){this.formData[1].data=[];const e=await Object(w["p"])({ID:t,channelType:2});if(200===e.code){const t=e&&e.data;this.channelMap=t,Object.keys(t).forEach(e=>{this.formData[1].data.push({label:t[e],value:e})})}},async handleChangeCode(t){this.defaultValue={channel:void 0},this.noData=!0;const e=this;await this.getChannels(t.ID),await this.getTowerDetail(t.ID),t.ID&&this.dateRange.length&&this.dateRange[0]&&this.dateRange[1]?(this.formData[1].disabled=!1,this.formData[2].disabled=!1,this.formData[2].pickerOptions={disabledDate(t){return t.getTime()>new Date(e.dateRange[1].split(" ")[0]).getTime()||t.getTime()<new Date(e.dateRange[0].split(" ")[0]).getTime()},shortcuts:[{text:"恢复默认",onClick(t){const a=new Date(e.dateRange[1].split(" ")[0]),i=new Date(e.dateRange[0].split(" ")[0]);t.$emit("pick",[i,a])}}]},this.defaultValue={queryTime:[e.dateRange[0].split(" ")[0],e.dateRange[1].split(" ")[0]]}):(this.defaultValue={queryTime:[]},this.formData[2].disabled=!0)},async getUpidData(t){this.timer&&clearInterval(this.timer),this.seriesData="",this.timer=setInterval(async()=>{const e=await Object(w["n"])({upid:t}).catch(()=>{this.timer&&clearInterval(this.timer)});if(e&&200===e.code){if("处理失败"===e.data)return this.timer&&clearInterval(this.timer),void this.$message.error("处理失败");"正在查询"===e.data&&this.$message({message:"正在查询",type:"warning",duration:1e3}),e.data&&Object(r["f"])(e.data)&&(this.noData=!1,this.channelList=e.data,this.seriesData=this.channelList["50yearmaxwind"]+" m/s",this.listLoading=!1,this.timer&&clearInterval(this.timer))}else this.timer&&clearInterval(this.timer)},1e3)},getData(t){if(!t.ID)return this.$message.error("测风塔选项不允许为空"),void(this.listLoading=!1);this.$refs.currencyForm.$refs.timeSeriesForm.validate(async e=>{if(!e)return console.log("error submit!!"),!1;{console.log(t.queryTime);const e={...t,startDate:t.queryTime[0],endDate:t.queryTime[1]};delete e.queryTime,this.formParams=e,this.listLoading=!0;const a=await Object(w["o"])(e);a&&200===a.code&&(a.data?await this.getUpidData(a.data):(console.log("50years请求失败",a),this.listLoading=!1))}}),this.listLoading=!0,this.title=this.channelMap[this.formParams.channel]+"预测50一遇最大风速：",this.customConfig=[{path:["series",0,"barMaxWidth"],val:"50px"}],this.listLoading=!1}}},It=xt,Ct=Object(f["a"])(It,Tt,vt,!1,null,null,null),Rt=Ct.exports,_t=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("CurrencyForm",{ref:"currencyForm",attrs:{"ref-name":"energyProduction","form-key":0,"config-data":t.formData,"form-handle":t.formHandle,inline:!1,"set-fields-value":t.defaultValue},on:{changeCode:t.handleChangeCode,changeTimeType:t.handleChangeTimeType,getData:t.getData}}),a("currency-chart",{attrs:{id:"energy-production-chart",title:t.title,"chart-x-data":t.chartXData,"series-data":t.seriesData,"custom-config":t.customConfig,"list-loading":t.listLoading,"is-not-data":t.noData}})],1)},Ot=[],St={name:"EnergyProduction",components:{CurrencyForm:o["a"],CurrencyChart:D},props:{idOptions:{type:Array,required:!0}},data(){return{skin:"#666",formData:[{type:"elSelect",variable:"ID",name:"测风塔:",multiple:!1,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择测风塔",trigger:"blur"}],disabled:!0,emit:"changeCode"},{type:"elSelect",variable:"channel",name:"风速通道:",multiple:!1,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择风速通道",trigger:"blur"}],disabled:!0},{type:"elDatePicker",variable:"queryTime",name:"时间:",valueFormat:"yyyy-MM-dd",pickerType:"daterange",colProps:{xl:8,lg:8,md:12,sm:12,xs:24},disabled:!0,required:!0,rules:[{required:!0,message:"请选择时间",trigger:"blur"}],pickerOptions:{}},{type:"elRadioGroup",variable:"time",name:"显示模式",multiple:!1,data:[{label:"日",value:"日"},{label:"月",value:"月"},{label:"年",value:"年"}],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择显示模式",trigger:"blur"}],emit:"changeTimeType"}],defaultValue:{ID:""},formHandle:[{type:"primary",name:"查询",emit:"getData"}],listLoading:!1,title:"",chartXData:[],seriesData:[],customConfig:[],channelList:null,dateRange:[],timer:null,noData:!0}},watch:{idOptions:{handler:function(t){this.formData[0].data=t.slice()},immediate:!0,deep:!0}},async mounted(){this.$route.query&&this.$route.query.id?(this.defaultValue={ID:this.$route.query.id},await this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)})):window.localStorage.getItem("ATM_CURRENT_TOWER_ID")&&(this.defaultValue={ID:window.localStorage.getItem("ATM_CURRENT_TOWER_ID")},this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)}))},beforeDestroy(){this.timer&&clearInterval(this.timer)},methods:{async getTowerDetail(t){window.localStorage.setItem("ATM_CURRENT_TOWER_ID",t);const e=await Object(b["e"])({ID:t}),a=e.data;a&&a.STARTTIME&&a.ENDTIME?this.dateRange=[a.STARTTIME,a.ENDTIME]:this.dateRange=[]},async getWindTower(){const t=await Object(b["a"])({userType:this.$store.getters.roles,organize:this.$store.getters.organize});if(200===t.code){const e=t&&t.data;console.log(e),this.formData[0].data=[],Object.keys(e).forEach(t=>{this.formData[0].data.push({label:e[t],value:t})})}},async getChannels(t){this.formData[1].data=[];const e=await Object(w["p"])({ID:t,channelType:2});if(200===e.code){const t=e&&e.data;console.log(t),Object.keys(t).forEach(e=>{this.formData[1].data.push({label:t[e],value:e})})}},async getDataDict(t){const e=await Object(w["c"])({ID:t});if(200===e.code){const t=e&&e.data;this.formData[2].data=[],Object.keys(t.time).forEach(e=>{this.formData[3].data.push({label:t.time[e],value:e})})}},async handleChangeCode(t){this.defaultValue={channel:void 0},this.noData=!0;const e=this;await this.getChannels(t.ID),await this.getTowerDetail(t.ID),t.ID&&this.dateRange.length&&this.dateRange[0]&&this.dateRange[1]?(this.formData[1].disabled=!1,this.formData[2].disabled=!1,this.formData[3].disabled=!1,this.formData[2].pickerOptions={disabledDate(t){return t.getTime()>new Date(e.dateRange[1].split(" ")[0]).getTime()||t.getTime()<new Date(e.dateRange[0].split(" ")[0]).getTime()},shortcuts:[{text:"恢复默认",onClick(t){const a=new Date(e.dateRange[1].split(" ")[0]),i=new Date(e.dateRange[0].split(" ")[0]);t.$emit("pick",[i,a])}}]},this.defaultValue={queryTime:[e.dateRange[0].split(" ")[0],e.dateRange[1].split(" ")[0]]}):(this.defaultValue={queryTime:[]},this.formData[2].disabled=!0)},async handleChangeTimeType(t,e){switch(t){case"日":return void(this.formData[3].valueFormat="yyyy-MM-dd");case"月":return void(this.formData[3].valueFormat="yyyy-MM");case"年":return void(this.formData[3].valueFormat="yyyy");default:this.formData[3].valueFormat="yyyy-MM-dd"}},async getUpidData(t){this.timer&&clearInterval(this.timer),this.timer=setInterval(async()=>{const e=await Object(w["n"])({upid:t}).catch(()=>{this.listLoading=!1,this.noData=!0,this.timer&&clearInterval(this.timer)});if(e&&200===e.code){if("处理失败"===e.data)return this.noData=!0,this.listLoading=!1,this.timer&&clearInterval(this.timer),void this.$message.error("处理失败");"正在查询"===e.data&&this.$message({message:"正在查询",type:"warning",duration:1e3}),e.data&&Object(r["f"])(e.data)&&(this.noData=!1,this.channelList=e.data,this.seriesData=[{name:"发电量估算",unit:this.channelList.Generation_unit,type:"line",smooth:!1,data:this.channelList.Generation}],this.chartXData=this.channelList.Date_Time,this.listLoading=!1,this.timer&&clearInterval(this.timer))}else this.noData=!0,this.listLoading=!1,this.timer&&clearInterval(this.timer)},1e3)},getData(t){if(!t.ID)return this.$message.error("测风塔选项不允许为空"),void(this.listLoading=!1);this.$refs.currencyForm.$refs.energyProduction.validate(async e=>{if(!e)return this.noData=!0,console.log("error submit!!"),!1;{const e={...t,startDate:t.queryTime[0],endDate:t.queryTime[1]};delete e.queryTime,this.listLoading=!0;const a=await Object(w["e"])(e);a&&200===a.code&&(a.data?await this.getUpidData(a.data):(console.log("请求失败",a),this.listLoading=!1))}}),this.title="发电量估算",this.customConfig=[{path:["series",0,"barMaxWidth"],val:"50px"}]}}},Et=St,Lt=Object(f["a"])(Et,_t,Ot,!1,null,null,null),$t=Lt.exports,qt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("CurrencyForm",{ref:"currencyForm",attrs:{"ref-name":"dataAnalysisForm","form-key":0,"config-data":t.formData,"form-handle":t.formHandle,inline:!1,"set-fields-value":t.defaultValue},on:{changeCode:t.handleChangeCode,changeType:t.handleChangeType,getData:t.getData}}),t.noData?t._e():[t.seriesData?a("p",{staticStyle:{"text-align":"right"}},[t._v("散点相关性R²值："+t._s(t.channelList.r_squared))]):t._e(),t.seriesData?a("LineMarker",{attrs:{id:"scatter-chart",title:t.title,width:"100%","chart-data":t.seriesData,"custom-config":t.customConfig,"list-loading":t.listLoading}}):t._e()]],2)},kt=[],At={name:"Scatter",components:{CurrencyForm:o["a"],LineMarker:ht},props:{idOptions:{type:Array,required:!0}},data(){return{skin:"#666",formData:[{type:"elSelect",variable:"ID",name:"测风塔:",multiple:!1,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择测风塔",trigger:"blur"}],disabled:!0,emit:"changeCode"},{type:"elDatePicker",variable:"queryTime",name:"时间:",valueFormat:"yyyy-MM-dd",pickerType:"daterange",colProps:{xl:8,lg:8,md:12,sm:12,xs:24},disabled:!0,required:!0,rules:[{required:!0,message:"请选择时间",trigger:"blur"}],pickerOptions:{}},{type:"elRadioGroup",variable:"dtype",name:"分析类型:",multiple:!1,data:[{label:"风速",value:"风速"},{label:"风向",value:"风向"}],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},disabled:!0,required:!0,rules:[{required:!0,message:"请选择分析类型",trigger:"blur"}],emit:"changeType"},{type:"elSelect",variable:"type1",name:"通道1:",multiple:!1,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},disabled:!0,required:!0,rules:[{required:!0,message:"请选择通道1",trigger:"blur"}]},{type:"elSelect",variable:"type2",name:"通道2:",multiple:!1,data:[],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},disabled:!0,required:!0,rules:[{required:!0,message:"请选择通道2",trigger:"blur"}]}],defaultValue:{},formHandle:[{type:"primary",name:"查询",emit:"getData"}],listLoading:!1,title:"",chartXData:[],seriesData:null,customConfig:[],channelList:null,dateRange:[],timer:null,wdOptions:[],wsOptions:[],setFieldsValue:{},noData:!0}},watch:{idOptions:{handler:function(t){this.formData[0].data=t.slice()},immediate:!0,deep:!0}},async mounted(){this.$route.query&&this.$route.query.id?(this.defaultValue={ID:this.$route.query.id},await this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)})):window.localStorage.getItem("ATM_CURRENT_TOWER_ID")&&(this.defaultValue={ID:window.localStorage.getItem("ATM_CURRENT_TOWER_ID")},this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)}))},beforeDestroy(){this.timer&&clearInterval(this.timer)},methods:{async getTowerDetail(t){window.localStorage.setItem("ATM_CURRENT_TOWER_ID",t);const e=await Object(b["e"])({ID:t}),a=e.data;a&&a.STARTTIME&&a.ENDTIME?this.dateRange=[a.STARTTIME,a.ENDTIME]:this.dateRange=[]},async getWindTower(){const t=await Object(b["a"])({userType:this.$store.getters.roles,organize:this.$store.getters.organize});if(200===t.code){const e=t&&t.data;console.log(e),this.formData[0].data=[],Object.keys(e).forEach(t=>{this.formData[0].data.push({label:e[t],value:t})})}},async getChannels(t){this.wdOptions=[],this.wsOptions=[];const e=await Object(w["p"])({ID:t,channelType:2});if(200===e.code){const t=e&&e.data;console.log(t),Object.keys(t).forEach(e=>{this.wsOptions.push({label:t[e],value:e})})}const a=await Object(w["p"])({ID:t,channelType:3});if(200===e.code){const t=a&&a.data;console.log(t),Object.keys(t).forEach(e=>{this.wdOptions.push({label:t[e],value:e})})}},async getDataDict(t){const e=await Object(w["q"])({ID:t});if(200===e.code){const t=e&&e.data;this.formData[2].data=[],Object.keys(t.dtype).forEach(e=>{this.formData[2].data.push({label:t.dtype[e],value:e})})}},async handleChangeCode(t){this.defaultValue={dtype:void 0,type1:void 0,type2:void 0},this.noData=!0,this.formData[3].disabled=!0,this.formData[4].disabled=!0;const e=this;await this.getChannels(t.ID),await this.getTowerDetail(t.ID),t.ID&&this.dateRange.length&&this.dateRange[0]&&this.dateRange[1]?(this.formData[1].disabled=!1,this.formData[2].disabled=!1,this.formData[1].pickerOptions={disabledDate(t){return t.getTime()>new Date(e.dateRange[1].split(" ")[0]).getTime()||t.getTime()<new Date(e.dateRange[0].split(" ")[0]).getTime()},shortcuts:[{text:"恢复默认",onClick(t){const a=new Date(e.dateRange[1].split(" ")[0]),i=new Date(e.dateRange[0].split(" ")[0]);t.$emit("pick",[i,a])}}]},this.defaultValue={queryTime:[e.dateRange[0].split(" ")[0],e.dateRange[1].split(" ")[0]]}):(this.defaultValue={queryTime:[]},this.formData[1].disabled=!0)},handleChangeType(t){this.defaultValue={type1:void 0,type2:void 0},"风向"===t&&(this.formData[3].data=this.wdOptions,this.formData[3].disabled=!1,this.formData[4].data=this.wdOptions,this.formData[4].disabled=!1),"风速"===t&&(this.formData[3].data=this.wsOptions,this.formData[3].disabled=!1,this.formData[4].data=this.wsOptions,this.formData[4].disabled=!1)},async getUpidData(t){this.timer&&clearInterval(this.timer),this.timer=setInterval(async()=>{const e=await Object(w["n"])({upid:t}).catch(()=>{this.timer&&clearInterval(this.timer)});if(e&&200===e.code){if("处理失败"===e.data)return this.timer&&clearInterval(this.timer),void this.$message.error("处理失败");if("正在查询"===e.data&&this.$message({message:"正在查询",type:"warning",duration:1e3}),e.data&&Object(r["f"])(e.data)){this.listLoading=!1,this.noData=!1,this.timer&&clearInterval(this.timer),this.channelList=e.data;const t=[],a=[];this.channelList.x_line&&this.channelList.x_line.map((e,i)=>{t.push([e,this.channelList.y_line[i]]),a.push([this.channelList["type1"][i],this.channelList["type2"][i]])}),this.seriesData={line:[{name:"拟合曲线",key:"相关性分析",value:t}],scatter:[{name:"观察点",key:"plol /0m风速 Avg (m/s) 拟合曲线 y-ax|b",value:a}],corrected:[],type:"scatter"},this.chartXData=this.channelList.type2,this.title="散点图"}}else this.timer&&clearInterval(this.timer)},1e3)},getData(t){if(!t.ID)return this.$message.error("测风塔选项不允许为空"),void(this.listLoading=!1);this.$refs.currencyForm.$refs.dataAnalysisForm.validate(async e=>{if(!e)return console.log("error submit!!"),!1;{this.noData=!0;const e={...t,startDate:t.queryTime[0],endDate:t.queryTime[1]};delete e.queryTime,this.listLoading=!0;const a=await Object(w["f"])(e);a&&200===a.code&&(a.data?await this.getUpidData(a.data):(console.log("timeSeries请求失败",a.msg),this.$message.error(a.msg),this.listLoading=!1))}}),this.listLoading=!0,this.title="散点分析",this.customConfig=[{path:["series",0,"barMaxWidth"],val:"50px"}],this.listLoading=!1}}},jt=At,Mt=Object(f["a"])(jt,qt,kt,!1,null,null,null),Vt=Mt.exports,Ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("CurrencyForm",{ref:"currencyForm",attrs:{"ref-name":"overflowForm","config-data":t.formData,"form-handle":t.formHandle,"set-fields-value":t.defaultValue,inline:!0},on:{getData:t.getData,changeCode:t.handleChangeCode}}),t.notData?a("div",{staticStyle:{"text-align":"center"}},[a("svg-icon",{staticClass:"data-icon",attrs:{"icon-class":"notdata"}}),a("p",{staticStyle:{"font-size":"16px",color:"#ccc"}},[t._v("无数据")])],1):[a("el-descriptions",{staticClass:"margin-top",attrs:{title:"",column:2,border:""}},t._l(t.tableData,(function(e,i){return a("el-descriptions-item",{key:i},[a("template",{slot:"label"},[t._v("\n          "+t._s(e.label)+"\n        ")]),t._v("\n        "+t._s(e.value)+"\n      ")],2)})),1),a("el-divider"),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"thisTable",staticStyle:{width:"100%"},attrs:{data:t.statisticTableData,fit:"",border:"",stripe:""}},t._l(t.itemsDescCodeArr,(function(e){return a("el-table-column",{key:e.dataIndex,attrs:{label:e.label,align:"center",resizable:!1,"show-overflow-tooltip":"",prop:e.dataIndex,width:e.width},scopedSlots:t._u([{key:"default",fn:function(i){var s=i.row;return[a("span",[t._v(t._s(s[e.dataIndex]))])]}}],null,!0)})})),1)]],2)},Wt=[],Nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.className,style:{height:t.height,width:t.width}})},Pt=[];a("817d");var Ht={mixins:[S["a"]],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"350px"},title:{type:String,default:""},autoResize:{type:Boolean,default:!0},theme:{type:String,default:""},chartData:{type:Array,required:!0},chartXData:{type:Array,default:function(){return[]}},chartYData:{type:Array,default:function(){return[]}}},data(){return{chart:null,yData:[],tmpLengendArr:[],yAxisLineColor:["#FF005A","#3888fa"]}},watch:{chartData:{deep:!0,handler(t){this.setOptions(t)}},theme:{handler(t){this.chart&&(this.chart.dispose(),this.initChart())}}},mounted(){this.$nextTick(()=>{this.initChart()})},beforeDestroy(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart(){this.chart=m.a.init(this.$el,this.theme),this.setOptions(this.chartData)},setOptions(t){this.tmpLengendArr=[];const e=this.setSeriesType(t);if(this.chartYData.length>0){this.yData=[];let t={};for(let e=0;e<this.chartYData.length;e++)t["name"]=this.chartData[e]["unit"],this.yData.push(t),t={}}else{this.yData=[];try{this.yData.push({name:t[0].unit})}catch(a){console.log(a)}}setTimeout(()=>{this.chart.setOption({title:{text:this.title,top:0,x:0,textStyle:{fontSize:"16",fontWeight:"bold"}},xAxis:{data:this.chartXData,boundaryGap:!1,axisTick:{show:!1}},grid:{left:10,right:10,bottom:30,top:60,containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"cross"},padding:[5,10]},yAxis:this.yData,legend:{type:"scroll",bottom:0,data:t.map((function(t){return t.name}))},series:e})},200)},setSeriesType(t){const e=[];for(let a=0;a<t.length;a++){this.tmpLengendArr||this.tmpLengendArr.push(t[a].name);const i={type:"line",smooth:!0,areaStyle:{normal:{color:new m.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(0, 136, 212, 0.3)"},{offset:.8,color:"rgba(0, 136, 212, 0)"}],!1),shadowColor:"rgba(0, 0, 0, 0.1)",shadowBlur:10}},yAxisIndex:this.chartYData&&t[a].name.indexOf(this.chartYData[1])>=0?1:0};i["name"]=t[a].name,i["data"]=t[a].value,e.push(i)}return e}}},Ut=Ht,zt=Object(f["a"])(Ut,Nt,Pt,!1,null,null,null),Xt=zt.exports,Bt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.className,style:{height:t.height,width:t.width}})},Gt=[];a("817d");var Yt={mixins:[S["a"]],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"350px"},theme:{type:String,default:""},color:{type:Array,default:function(){return[]}},title:{type:String,default:""},chartData:{type:Array,required:!0},chartXData:{type:Array,required:!0},colorArr:{type:Array,default:function(){return[]}}},data(){return{chart:null,tmpSeries:[],tmpLengendArr:[],tmpObj:{}}},watch:{chartData:{deep:!0,handler(t){this.setOptions(t)}},chartXData:{deep:!0,handler(){this.initChart()}},theme:{handler(t){this.chart&&(this.chart.dispose(),this.initChart())}}},mounted(){this.$nextTick(()=>{this.initChart()})},beforeDestroy(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart(){this.chart=m.a.init(this.$el,this.theme),this.setOptions(this.chartData)},setOptions(t){this.tmpSeries=[],this.tmpLengendArr=[];for(let e=0;e<t.length;e++)this.tmpObj={},this.tmpLengendArr.push(t[e].name),this.tmpObj["name"]=t[e].name,this.tmpObj["type"]="bar",this.colorArr.length>0&&(this.tmpObj["itemStyle"]={color:this.colorArr[e]}),this.tmpObj["data"]=t[e].value,this.tmpSeries.push(this.tmpObj);this.tmpObj={},setTimeout(()=>{this.chart.setOption({title:{text:this.title,x:"10",top:20,textStyle:{fontSize:"16",fontWeight:"bold"}},legend:{x:"right",type:"scroll",bottom:0,data:this.tmpLengendArr},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:10,right:10,bottom:30,top:60,containLabel:!0},xAxis:[{type:"category",data:this.chartXData,axisTick:{alignWithLabel:!0}}],yAxis:[{type:"value",axisTick:{show:!1}}],series:this.tmpSeries})},200)}}},Jt=Yt,Zt=Object(f["a"])(Jt,Bt,Gt,!1,null,null,null),Kt=Zt.exports;const Qt=[{field:"ID",label:"测风塔编号"},{field:"LAT",label:"纬度"},{field:"LON",label:"经度"},{field:"altitude",label:"海拔"},{field:"STARTTIME",label:"数据起测日期"},{field:"ENDTIME",label:"数据截止日期"},{field:"dataDuration",label:"测风数据时长"},{field:"SHEAR",label:"风切变曲线指数"},{field:"airDensity",label:"空气密度"}];var te={name:"Statistic",components:{CurrencyForm:o["a"],RoseChart:q,BarChart:Kt,LineChart:Xt},props:{idOptions:{type:Array,required:!0}},data(){return{currentId:"",notData:!0,total:0,tableData:[],statisticTableData:[],lineChartXData:[],lineSeriesData:[],listLoading:!1,formData:[{type:"elSelect",variable:"id",name:"风塔名称:",data:[],colProps:{xl:6,lg:6,md:8,sm:12,xs:24},disabled:!0,emit:"changeCode",rules:[{required:!0,message:"请选择风塔",trigger:"blur"}]},{type:"elDatePicker",variable:"queryTime",name:"查询时间:",valueFormat:"yyyy-MM-dd",pickerType:"daterange",width:"280px",colProps:{xl:6,lg:6,md:8,sm:12,xs:24},rules:[{required:!0,message:"请选择查询时间",trigger:"blur"}]}],formHandle:[{type:"primary",name:"查询",emit:"getData"}],defaultValue:{},itemsDescCodeArr:[{dataIndex:"channelName",label:"通道名称",width:"180px"},{dataIndex:"UNIT",label:"单位",width:"100px"},{dataIndex:"HEIGHT",label:"高度",width:"100px"},{dataIndex:"total",label:"应测数据个数",width:"120px"},{dataIndex:"useable",label:"实测数据个数",width:"120px"},{dataIndex:"miss",label:"缺测数据个数",width:"120px"},{dataIndex:"invalid",label:"无效数据个数（根据清洗规则而定）",width:"120px"},{dataIndex:"ice",label:"冰冻数据个数（若使用冰冻检测）",width:"120px"},{dataIndex:"recovery",label:"数据完整率",width:"150px"},{dataIndex:"avg",label:"平均值",width:"120px"},{dataIndex:"min",label:"最小值",width:"120px"},{dataIndex:"max",label:"最大值",width:"120px"},{dataIndex:"std",label:"标准差"}],title:{wd:"",wp:"",monthws:"",wsdis:"",wpdis:"",dayws:""},customConfig:{},dateRange:[]}},watch:{idOptions:{handler:function(t){this.formData[0].data=t.slice()},immediate:!0,deep:!0}},async mounted(){this.$route.query&&this.$route.query.id?(this.currentId=this.$route.query.id,this.defaultValue.id=this.currentId,this.$set(this.defaultValue,"id",this.currentId),console.log(this.defaultValue),await this.handleChangeCode(this.defaultValue),await this.$refs.currencyForm.returnDisplay(this.defaultValue),await this.getData(this.defaultValue)):window.localStorage.getItem("ATM_CURRENT_TOWER_ID")&&(this.defaultValue={id:window.localStorage.getItem("ATM_CURRENT_TOWER_ID")},this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)}))},methods:{getTimeDiff:r["e"],async getWindTower(){const t=await Object(b["a"])({userType:this.$store.getters.roles,organize:this.$store.getters.organize});if(200===t.code){const e=t&&t.data;this.formData[0].data=[],Object.keys(e).forEach(t=>{this.formData[0].data.push({label:e[t],value:t})})}},async getTowerDetail(t){window.localStorage.setItem("ATM_CURRENT_TOWER_ID",t);const e=await Object(b["e"])({ID:t}),a=e.data;a&&a.STARTTIME&&a.ENDTIME?this.dateRange=[a.STARTTIME,a.ENDTIME]:this.dateRange=[],this.tableData=[];for(let i=0;i<Qt.length;i++){const t={label:"",value:""};if(t.label=Qt[i].label,"dataDuration"===Qt[i].field){const e=this.getTimeDiff(new Date(a["STARTTIME"]).getTime(),new Date(a["ENDTIME"]).getTime());t.value=`${e.days}天${e.hours}小时${e.minutes}分`}else t.value=a[Qt[i].field];this.tableData.splice(i,1,t)}},async handleChangeCode(t){this.notData=!0;const e=this;await this.getTowerDetail(t.id),this.formData[1].disabled=!1,t.id&&this.dateRange.length&&this.dateRange[0]&&this.dateRange[1]?(this.formData[1].pickerOptions={disabledDate(t){return t.getTime()>new Date(e.dateRange[1].split(" ")[0]).getTime()||t.getTime()<new Date(e.dateRange[0].split(" ")[0]).getTime()},shortcuts:[{text:"恢复默认",onClick(t){const a=new Date(e.dateRange[1].split(" ")[0]),i=new Date(e.dateRange[0].split(" ")[0]);t.$emit("pick",[i,a])}}]},this.defaultValue={id:t.id,queryTime:[e.dateRange[0].split(" ")[0],e.dateRange[1].split(" ")[0]]}):(this.defaultValue={queryTime:[]},this.formData[1].disabled=!0)},async getData(t){if(console.log(t),!t.id)return this.$message.error("测风塔选项不允许为空"),void(this.listLoading=!1);this.$refs.currencyForm.$refs.overflowForm.validate(async e=>{if(!e)return console.log("error submit!!"),!1;{this.listLoading=!0;const e=await Object(w["r"])({ID:t.id,startDate:t.queryTime[0],endDate:t.queryTime[1]});if(e&&200===e.code){const t=e.data&&e.data.items;"{}"!==JSON.stringify(t)?this.notData=!1:this.notData=!0,this.listLoading=!0,this.statisticTableData=t.slice(),this.listLoading=!1}}})}}},ee=te,ae=(a("d356"),Object(f["a"])(ee,Ft,Wt,!1,null,"705ac283",null)),ie=ae.exports,se=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("CurrencyForm",{ref:"currencyForm",attrs:{"ref-name":"exportForm","form-key":0,"config-data":t.formData,"form-handle":t.formHandle,inline:!1,"set-fields-value":t.defaultValue},on:{changeCode:t.handleChangeCode,"change-form":t.handleChangeForm,getExport:t.getData}})],1)},re=[],ne={name:"Export",components:{CurrencyForm:o["a"],RoseChart:q},props:{idOptions:{type:Array,required:!0}},data(){return{formData:[{type:"elSelect",variable:"ID",name:"测风塔:",multiple:!1,data:[],width:"280px",colProps:{xl:8,lg:8,md:12,sm:12,xs:24},required:!0,rules:[{required:!0,message:"请选择测风塔",trigger:"blur"}],disabled:!0,emit:"changeCode"},{type:"elRadioGroup",variable:"form",name:"导出格式:",componentType:"el-radio-button",width:"450px",multiple:!1,data:[{label:"月度报表",value:"月度报表"},{label:"时间序列",value:"时间序列"},{label:"WT",value:"WT"},{label:"WindSim",value:"WindSim"},{label:"WAsP",value:"WAsP"}],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},disabled:!0,rules:[{required:!0,message:"请选择导出格式",trigger:"blur"}],emit:"change-form"},{type:"elRadioGroup",variable:"source",name:"数据源:",multiple:!1,data:[{label:"原始数据",value:"原始数据"},{label:"清洗数据",value:"清洗数据"}],colProps:{xl:8,lg:8,md:12,sm:12,xs:24},disabled:!0,rules:[{required:!0,message:"请选择数据源",trigger:"blur"}]},{type:"elDatePicker",variable:"queryTime",name:"时间:",valueFormat:"yyyy-MM-dd",width:"280px",pickerType:"daterange",colProps:{xl:8,lg:8,md:12,sm:12,xs:24},disabled:!0,rules:[{required:!0,message:"请选择时间",trigger:"blur"}],ifShow:!1},{type:"elSelect",variable:"type",name:"全部通道:",multiple:!0,data:[],width:"100%",colProps:{xl:8,lg:8,md:8,sm:12,xs:24,offset:8},disabled:!0,rules:[{required:!0,message:"请选择通道",trigger:"blur"}],ifShow:!1},{type:"elSelect",variable:"type1",name:"风速通道:",multiple:!1,data:[],width:"300px",colProps:{xl:8,lg:8,md:12,sm:12,xs:24},disabled:!0,rules:[{required:!0,message:"请选择风速通道",trigger:"blur"}],ifShow:!1},{type:"elSelect",variable:"type2",name:"风向通道:",multiple:!1,data:[],width:"300px",colProps:{xl:8,lg:8,md:12,sm:12,xs:24},disabled:!0,rules:[{required:!0,message:"请选择风向通道",trigger:"blur"}],ifShow:!1}],mastDetail:{},defaultValue:{source:"原始数据"},formHandle:[{type:"primary",name:"导出",emit:"getExport"}],listLoading:!1,title:"",chartXData:[],seriesData:[],roseDict:{},formParams:{},customConfig:[],upid:"",dateRange:[],channelList:[],timer:null,noData:!0}},watch:{idOptions:{handler:function(t){this.formData[0].data=t.slice()},immediate:!0,deep:!0}},async mounted(){this.$route.query&&this.$route.query.id?(this.defaultValue={ID:this.$route.query.id},await this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)})):window.localStorage.getItem("ATM_CURRENT_TOWER_ID")&&(this.defaultValue={ID:window.localStorage.getItem("ATM_CURRENT_TOWER_ID")},this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)}))},beforeDestroy(){this.timer&&clearInterval(this.timer)},methods:{async getTowerDetail(t){window.localStorage.setItem("ATM_CURRENT_TOWER_ID",t);const e=await Object(b["e"])({ID:t}),a=e.data;this.mastDetail=a,a&&a.STARTTIME&&a.ENDTIME?this.dateRange=[a.STARTTIME,a.ENDTIME]:this.dateRange=[]},async getWindTower(){const t=await Object(b["a"])({userType:this.$store.getters.roles,organize:this.$store.getters.organize});if(200===t.code){const e=t&&t.data;this.formData[0].data=[],Object.keys(e).forEach(t=>{this.formData[0].data.push({label:e[t],value:t})})}},async getChannels(t){this.formData[2].data=[];const e=await Object(w["p"])({ID:t,channelType:2});if(200===e.code){const t=e&&e.data;Object.keys(t).forEach(e=>{this.formData[2].data.push({label:t[e],value:e})})}},async getWdChannels(t,e){this.formData[e+3].data=[];const a=await Object(w["p"])({ID:t,channelType:e});if(200===a.code){const t=a&&a.data;Object.keys(t).forEach(a=>{this.formData[e+3].data.push({label:t[a],value:a})})}},handleChangeDateRange(){const t=this;this.formData[3].pickerOptions={disabledDate(e){return e.getTime()>new Date(t.dateRange[1].split(" ")[0]).getTime()||e.getTime()<new Date(t.dateRange[0].split(" ")[0]).getTime()},shortcuts:[{text:"恢复默认",onClick(e){const a=new Date(t.dateRange[1].split(" ")[0]),i=new Date(t.dateRange[0].split(" ")[0]);e.$emit("pick",[i,a])}}]}},async handleChangeCode(t){t&&t.ID?(this.defaultValue={ID:t.ID},this.formData[1].disabled=!1,this.formData[2].disabled=!1,console.log(this.defaultValue),this.noData=!0,await this.getTowerDetail(t.ID),this.formData[3].disabled=!1,this.dateRange.length&&this.dateRange[0]&&this.dateRange[1]?(this.handleChangeDateRange(),this.defaultValue={...this.defaultValue,queryTime:[this.dateRange[0].split(" ")[0],this.dateRange[1].split(" ")[0]]}):(this.defaultValue={ID:t.ID,queryTime:[]},this.formData[3].disabled=!0)):(this.formData[1].disabled=!0,this.formData[2].disabled=!0)},async handleChangeForm(t){if(console.log(t),t)switch(this.formData[4].disabled=!1,t){case"WT":case"WindSim":case"WAsP":this.formData[3].ifShow=!0,this.formData[4].ifShow=!1,this.formData[5].ifShow=!0,this.formData[6].ifShow=!0,await this.getWdChannels(this.defaultValue.ID,2),await this.getWdChannels(this.defaultValue.ID,3),this.formData[5].disabled=!1,this.formData[6].disabled=!1,this.handleChangeDateRange(),this.defaultValue={...this.defaultValue,queryTime:[this.dateRange[0].split(" ")[0],this.dateRange[1].split(" ")[0]],type:void 0};break;case"时间序列":this.formData[3].ifShow=!0,this.formData[4].ifShow=!0,this.formData[5].ifShow=!1,this.formData[6].ifShow=!1,await this.getWdChannels(this.defaultValue.ID,1),this.formData[3].disabled=!1,this.formData[4].disabled=!1,this.handleChangeDateRange(),this.defaultValue={...this.defaultValue,queryTime:[this.dateRange[0].split(" ")[0],this.dateRange[1].split(" ")[0]],type1:void 0,type2:void 0};break;case"月度报表":this.formData[3].ifShow=!0,this.formData[4].ifShow=!1,this.formData[5].ifShow=!1,this.formData[6].ifShow=!1,this.handleChangeDateRange(),this.defaultValue={...this.defaultValue,queryTime:[this.dateRange[0].split(" ")[0],this.dateRange[1].split(" ")[0]],type:void 0,type1:void 0,type2:void 0};break;default:this.formData[3].ifShow=!0,this.formData[4].ifShow=!1,this.formData[5].ifShow=!1,this.formData[6].ifShow=!1}else this.formData[3].disabled=!0,this.formData[4].disabled=!0,this.formData[5].disabled=!0,this.formData[6].disabled=!0},getData(t){if(!t.ID)return this.$message.error("测风塔选项不允许为空"),void(this.listLoading=!1);this.$refs.currencyForm.$refs.exportForm.validate(async e=>{if(!e)return console.log("error submit!!"),!1;{console.log(t);const e={...t,startDate:t.queryTime&&t.queryTime[0]||void 0,endDate:t.queryTime&&t.queryTime[1]||void 0,type:t.type?t.type.join(","):void 0};delete e.queryTime,this.formParams=e,this.listLoading=!0;const a=await Object(w["b"])(e),i=new Blob([a.data]),s=window.URL.createObjectURL(i),r=document.createElement("a");r.style.display="none",r.href=s,r.setAttribute("download",`${t.ID}_interpolation.${"月度报表"===t.form?"xlsx":"时间序列"===t.form?"txt":"WT"===t.form?"tim":"WindSim"===t.form?"tws":"WAsP"===t.form?"tab":"txt"}`),"undefined"===typeof r.download&&r.setAttribute("target","_blank"),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(s)}})}}},le=ne,oe=Object(f["a"])(le,se,re,!1,null,null,null),de=oe.exports;const he=[{field:"ID",label:"测风塔编号"},{field:"LAT",label:"纬度"},{field:"LON",label:"经度"},{field:"altitude",label:"海拔"},{field:"STARTTIME",label:"数据起测日期"},{field:"ENDTIME",label:"数据截止日期"},{field:"dataDuration",label:"测风数据时长"},{field:"SHEAR",label:"风切变曲线指数"},{field:"airDensity",label:"空气密度"}];var ce={name:"AnalysisOverflow",components:{CurrencyForm:o["a"],RoseChart:q,BarChart:Kt,LineChart:Xt,TimeSeries:I,DataRose:M,SpeedPowerdensity:H,EnergyFrequency:Y,Weibull:et,Shear:gt,Turbulence:wt,MaximumSpeed50years:Rt,EnergyProduction:$t,Scatter:Vt,Statistic:ie,Export:de},data(){return{currentId:"",notData:!0,tableData:[],lineChartXData:[],lineSeriesData:[],listLoading:!1,formData:[{type:"elSelect",variable:"id",name:"风塔名称:",data:[],colProps:{xl:6,lg:6,md:8,sm:12,xs:24},disabled:!1,emit:"changeCode",rules:[{required:!0,message:"请选择风塔",trigger:"blur"}]},{type:"elDatePicker",variable:"queryTime",name:"查询时间:",valueFormat:"yyyy-MM-dd",pickerType:"daterange",width:"280px",colProps:{xl:6,lg:6,md:8,sm:12,xs:24},rules:[{required:!0,message:"请选择查询时间",trigger:"blur"}]}],formHandle:[{type:"primary",name:"查询",emit:"getData"}],defaultValue:{},chartDataWd:[],chartXDataWd:[],chartDataWp:[],chartXDataWp:[],chartXDataMonthws:[],chartDataMonthws:[],chartXDataWsdis:[],chartDataWsdis:[],chartXDataWpdis:[],chartDataWpdis:[],chartXDataDayws:[],chartDataDayws:[],title:{wd:"",wp:"",monthws:"",wsdis:"",wpdis:"",dayws:""},customConfig:{},dateRange:[],activeName:"overflow",loading:null,idOptions:[]}},async mounted(){this.handleTabChange({name:this.activeName}),await this.getWindTower(),this.$route.query&&this.$route.query.id?(this.currentId=this.$route.query.id,this.defaultValue.id=this.currentId,this.$set(this.defaultValue,"id",this.currentId),console.log(this.defaultValue),await this.handleChangeCode(this.defaultValue),window.localStorage.setItem("ATM_CURRENT_TOWER_ID",this.defaultValue.id),await this.$refs.currencyForm.returnDisplay(this.defaultValue)):window.localStorage.getItem("ATM_CURRENT_TOWER_ID")&&(this.defaultValue={id:window.localStorage.getItem("ATM_CURRENT_TOWER_ID")},this.$refs.currencyForm.returnDisplay(this.defaultValue),this.$nextTick(async()=>{await this.handleChangeCode(this.defaultValue)}))},methods:{getTimeDiff:r["e"],async handleTabChange(t){},async getWindTower(){const t=await Object(b["a"])({userType:this.$store.getters.roles,organize:this.$store.getters.organize});if(200===t.code){const e=t&&t.data;this.formData[0].data=[],Object.keys(e).forEach(t=>{this.formData[0].data.push({label:e[t],value:t})}),this.idOptions=this.formData[0].data.slice()}},async getTowerDetail(t){this.loading=this.$loading({lock:!0,text:"加载中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.3)"}),window.localStorage.setItem("ATM_CURRENT_TOWER_ID",t);const e=await Object(b["e"])({ID:t}).catch(t=>{this.loading.close()});this.loading.close();const a=e.data;a&&a.STARTTIME&&a.ENDTIME?this.dateRange=[a.STARTTIME,a.ENDTIME]:this.dateRange=[]},async handleChangeCode(t){this.notData=!0;const e=this;await this.getTowerDetail(t.id),this.formData[1].disabled=!1,t.id&&this.dateRange.length&&this.dateRange[0]&&this.dateRange[1]?(this.formData[1].pickerOptions={disabledDate(t){return t.getTime()>new Date(e.dateRange[1].split(" ")[0]).getTime()||t.getTime()<new Date(e.dateRange[0].split(" ")[0]).getTime()},shortcuts:[{text:"恢复默认",onClick(t){const a=new Date(e.dateRange[1].split(" ")[0]),i=new Date(e.dateRange[0].split(" ")[0]);t.$emit("pick",[i,a])}}]},this.defaultValue={id:t.id,queryTime:[e.dateRange[0].split(" ")[0],e.dateRange[1].split(" ")[0]]},await this.$refs.currencyForm.returnDisplay(this.defaultValue),await this.getData(this.defaultValue)):(this.defaultValue={queryTime:[]},this.formData[1].disabled=!0)},async getData(t){if(console.log(t),!t.id)return this.$message.error("测风塔不允许为空"),void(this.listLoading=!1);this.$refs.currencyForm.$refs.overflowForm.validate(async e=>{if(!e)return console.log("error submit!!"),!1;{this.listLoading=!0;const e=await Object(b["e"])({ID:t.id,startDate:t.queryTime[0],endDate:t.queryTime[1]});if(e&&200===e.code){const t=e.data;this.tableData=[];for(let e=0;e<he.length;e++){const a={label:"",value:""};if(a.label=he[e].label,"dataDuration"===he[e].field){const e=this.getTimeDiff(new Date(t["STARTTIME"]).getTime(),new Date(t["ENDTIME"]).getTime());a.value=`${e.days}天${e.hours}小时${e.minutes}分`}else a.value=t[he[e].field];this.tableData.splice(e,1,a)}Object(r["f"])(t)&&Object.keys(t).length?(console.log(Object(r["f"])(t),Object.keys(t).length),this.notData=!1):this.notData=!0,this.listLoading=!0,this.title.wd="风向玫瑰",this.chartDataWd=t.wd.seriesData,this.chartXDataWd=t.wd.xAxisData,this.title.wp="风能玫瑰",this.chartDataWp=t.wp.seriesData,this.chartXDataWp=t.wp.xAxisData,this.title.monthws=t.monthws.name;const a=t.monthws.seriesData,i=t.monthws.legendData;this.chartDataMonthws=[];for(let e=0;e<a.length;e++){const t={name:i[e],unit:"m/s",type:"line",smooth:!1,value:a[e]};this.chartDataMonthws.push(t)}this.chartXDataMonthws=t.monthws.xAxisData,this.title.wsdis=t.wsdis.name;const s=t.wsdis.seriesData,n=t.wsdis.legendData;this.chartDataWsdis=[];for(let e=0;e<s.length;e++){const t={name:n[e],unit:"",type:"bar",smooth:!1,value:s[e]};this.chartDataWsdis.push(t)}this.chartXDataWsdis=t.wsdis.xAxisData,this.title.wpdis=t.wpdis.name;const l=t.wpdis.seriesData,o=t.wpdis.legendData;this.chartDataWpdis=[];for(let e=0;e<l.length;e++){const t={name:o[e],unit:"",type:"bar",smooth:!1,value:l[e]};this.chartDataWpdis.push(t)}this.chartXDataWpdis=t.wpdis.xAxisData,this.title.dayws=t.dayws.name;const d=t.dayws.seriesData,h=t.dayws.legendData;this.chartDataDayws=[];for(let e=0;e<d.length;e++){const t={name:h[e],unit:"",type:"line",smooth:!1,value:d[e]};this.chartDataDayws.push(t)}this.chartXDataDayws=t.dayws.xAxisData,this.listLoading=!1}}})}}},me=ce,ue=(a("ad6e"),Object(f["a"])(me,i,s,!1,null,"02e22a97",null));e["default"]=ue.exports},ad6e:function(t,e,a){"use strict";a("f241")},d356:function(t,e,a){"use strict";a("165e")},e50c:function(t,e,a){"use strict";a.d(e,"d",(function(){return n})),a.d(e,"s",(function(){return l})),a.d(e,"n",(function(){return o})),a.d(e,"l",(function(){return d})),a.d(e,"k",(function(){return h})),a.d(e,"a",(function(){return c})),a.d(e,"m",(function(){return m})),a.d(e,"j",(function(){return u})),a.d(e,"o",(function(){return g})),a.d(e,"i",(function(){return p})),a.d(e,"g",(function(){return f})),a.d(e,"c",(function(){return y})),a.d(e,"e",(function(){return D})),a.d(e,"t",(function(){return b})),a.d(e,"h",(function(){return w})),a.d(e,"q",(function(){return T})),a.d(e,"f",(function(){return v})),a.d(e,"p",(function(){return x})),a.d(e,"r",(function(){return I})),a.d(e,"b",(function(){return C}));var i=a("b775");const s=window.GLOBAL_CONFIG.VUE_APP_BASE_API,r=window.GLOBAL_CONFIG.VUE_APP_BASE_API_2;function n(t){return Object(i["a"])({url:s+"/atm/analysis/avgchannellist",method:"get",params:t})}function l(t){return Object(i["a"])({url:r+"/atm/analysis/timeseries",method:"get",params:t})}function o(t){return Object(i["a"])({url:r+"/atm/getUpidData",method:"get",params:t})}function d(t){return Object(i["a"])({url:s+"/atm/analysis/getrosedict",method:"get",params:t})}function h(t){return Object(i["a"])({url:r+"/atm/analysis/getrose",method:"get",params:t})}function c(t){return Object(i["a"])({url:r+"/atm/analysis/dailyanalysis",method:"get",params:t})}function m(t){return Object(i["a"])({url:r+"/atm/analysis/dailyanalysis",method:"get",params:t})}function u(t){return Object(i["a"])({url:r+"/atm/analysis/frequencyanalysis",method:"get",params:t})}function g(t){return Object(i["a"])({url:r+"/atm/analysis/yearmaxwind50",method:"get",params:t})}function p(t){return Object(i["a"])({url:r+"/atm/analysis/weibullanalysis",method:"get",params:t})}function f(t){return Object(i["a"])({url:r+"/atm/analysis/shearanalysis",method:"get",params:t})}function y(t){return Object(i["a"])({url:s+"/atm/analysis/generationdict",method:"get",params:t})}function D(t){return Object(i["a"])({url:r+"/atm/analysis/generation",method:"get",params:t})}function b(t){return Object(i["a"])({url:s+"/atm/analysis/turbulencedict",method:"get",params:t})}function w(t){return Object(i["a"])({url:r+"/atm/analysis/turbulence",method:"get",params:t})}function T(t){return Object(i["a"])({url:s+"/atm/analysis/scatterdict",method:"get",params:t})}function v(t){return Object(i["a"])({url:r+"/atm/analysis/scatter",method:"get",params:t})}function x(t){return Object(i["a"])({url:r+"/atm/channel/list",method:"get",params:t})}function I(t){return Object(i["a"])({url:r+"/atm/analysis/statistics",method:"post",data:t})}function C(t){return Object(i["a"])({url:r+"/atm/analysis/download",method:"post",data:t,responseType:"blob"})}},f241:function(t,e,a){}}]);